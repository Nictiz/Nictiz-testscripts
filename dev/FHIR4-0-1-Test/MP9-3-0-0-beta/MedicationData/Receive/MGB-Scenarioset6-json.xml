<?xml version="1.0" encoding="UTF-8"?>
<TestScript xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript">
   <id value="mp9-meddata-receive-6-x-json"/>
   <meta>
      <profile value="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript"/>
   </meta>
   <url value="http://nictiz.nl/fhir/TestScript/mp9-meddata-receive-6-x-json"/>
   <name value="MP9 - Server - Scenario 6.x - Receive MedicationData - JSON Format"/>
   <status value="active"/>
   <publisher value="Nictiz"/>
   <contact>
      <name value="Nictiz"/>
      <telecom>
         <system value="email"/>
         <value value="kwalificatie@nictiz.nl"/>
         <use value="work"/>
      </telecom>
   </contact>
   <description value="Scenario 6.x - Receive MedicationData for G. XXX_Hemsbergen."/>
   <origin>
      <index value="1"/>
      <profile>
         <system value="http://terminology.hl7.org/CodeSystem/testscript-profile-origin-types"/>
         <code value="FHIR-Client"/>
      </profile>
   </origin>
   <destination>
      <index value="1"/>
      <profile>
         <system value="http://terminology.hl7.org/CodeSystem/testscript-profile-destination-types"/>
         <code value="FHIR-Server"/>
      </profile>
   </destination>
   <fixture id="mgsets-mp-smg-tst-MGB-Scenarioset6-v30">
      <autocreate value="false"/>
      <autodelete value="false"/>
      <resource>
         <reference value="../../_reference/fixtures/mgsets-mp-smg-tst-MGB-Scenarioset6-v30.json"/>
      </resource>
   </fixture>
   <profile id="Bundle-profile">
      <reference value="http://hl7.org/fhir/StructureDefinition/Bundle"/>
   </profile>
   <variable>
      <name value="T"/>
      <defaultValue value="${CURRENTDATE}"/>
      <description value="Date that data and queries are expected to be relative to."/>
   </variable>
   <test id="scenario6-x-receive-meddata">
      <name value="Operation and general checks"/>
      <description value="Specifies the query that runs and general checks on the response."/>
      <action>
         <operation>
            <type>
               <system value="http://terminology.hl7.org/CodeSystem/testscript-operation-codes"/>
               <code value="transaction"/>
            </type>
            <description value="Test server to handle a Bundle of type transaction."/>
            <accept value="json"/>
            <contentType value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <requestHeader>
               <field value="Prefer"/>
               <value value="return=representation"/>
            </requestHeader>
            <responseId value="transaction-response"/>
            <sourceId value="mgsets-mp-smg-tst-MGB-Scenarioset6-v30"/>
         </operation>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="true"/>
            </extension>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the returned Bundle type is transaction-response."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <value value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that literal References (Reference.reference) are an absolute URL, a relative URL or an internal fragment reference (contained), see: http://hl7.org/fhir/stu3/references.html#literal."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this as Reference).reference.all( startsWith('http://') or startsWith('https://') or startsWith('#') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or (startsWith('urn:').not() and startsWith('#').not() and matches('^[A-Za-z]{3,}/[^/]+$')) )"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that all coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).all(system.exists() and code.exists())"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2').not()"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 16 MedicationStatement resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(MedicationStatement)).count() = 16"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 15 Medication resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(Medication)).count() = 15"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="scenario6-x-receive-meddata-identification">
      <name value="Resource identification"/>
      <description value="Checks if all resources specified by the scenario can be identified unambiguously."/>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '48291|urn:oid:2.16.840.1.113883.2.4.4.10' (MIZOLASTINE TABLET MGA  10MG)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '48291')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '68519|urn:oid:2.16.840.1.113883.2.4.4.10' (AMOXICILLINE DISPERTABLET 500MG)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '68519')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '67903|urn:oid:2.16.840.1.113883.2.4.4.10' (PARACETAMOL 500MG TABLET)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '67903')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '92789|urn:oid:2.16.840.1.113883.2.4.4.10' (Cetomacrogolcreme met vaseline 10%)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '92789')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '20850|urn:oid:2.16.840.1.113883.2.4.4.10' (NAPROXEN 500MG TABLET)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '20850')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '72664|urn:oid:2.16.840.1.113883.2.4.4.10' (WATERSTOFPEROXIDE CONC VOOR MONDSPOELING 30MG/ML)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '72664')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 2 MedicationStatement resource(s) that reference(s) Medication with code '1090|urn:oid:2.16.840.1.113883.2.4.4.10' (METFORMINE 500MG TABLET)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '1090')).count() = 2"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '55050|urn:oid:2.16.840.1.113883.2.4.4.10' (IMIQUIMOD 50MG/G CREME)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '55050')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '77038|urn:oid:2.16.840.1.113883.2.4.4.10' (EZETIMIB/SIMVASTATINE 10/20)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '77038')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '16292|urn:oid:2.16.840.1.113883.2.4.4.10' (ETHINYLESTRADIOL/DESOGESTREL TABLET 30/150UG)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '16292')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '16705|urn:oid:2.16.840.1.113883.2.4.4.10' (Fusidinezuur creme 20mg/g)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '16705')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '42773|urn:oid:2.16.840.1.113883.2.4.4.10' (CODEINE TABLET 10MG (FOSFAAT))"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '42773')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '3956|urn:oid:2.16.840.1.113883.2.4.4.10' (ACETYLSALICYLZUUR 100MG TAB)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '3956')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '94692|urn:oid:2.16.840.1.113883.2.4.4.10' (MORFINE INFVLST 5MG/ML CAS 100ML)"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '94692')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 MedicationStatement resource(s) that reference(s) Medication with code '44520|urn:oid:2.16.840.1.113883.2.4.4.10' (NITROGLYCERINE PLEISTER 5MG/24UUR (DEPONIT T))"/>
            <expression value="Bundle.entry.select(resource as MedicationStatement).where(medication.resolve().code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '44520')).count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '48291|urn:oid:2.16.840.1.113883.2.4.4.10' (MIZOLASTINE TABLET MGA  10MG)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '48291').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '68519|urn:oid:2.16.840.1.113883.2.4.4.10' (AMOXICILLINE DISPERTABLET 500MG)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '68519').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '67903|urn:oid:2.16.840.1.113883.2.4.4.10' (PARACETAMOL 500MG TABLET)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '67903').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '92789|urn:oid:2.16.840.1.113883.2.4.4.10' (Cetomacrogolcreme met vaseline 10%)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '92789').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '20850|urn:oid:2.16.840.1.113883.2.4.4.10' (NAPROXEN 500MG TABLET)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '20850').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '72664|urn:oid:2.16.840.1.113883.2.4.4.10' (WATERSTOFPEROXIDE CONC VOOR MONDSPOELING 30MG/ML)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '72664').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '1090|urn:oid:2.16.840.1.113883.2.4.4.10' (METFORMINE 500MG TABLET)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '1090').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '55050|urn:oid:2.16.840.1.113883.2.4.4.10' (IMIQUIMOD 50MG/G CREME)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '55050').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '77038|urn:oid:2.16.840.1.113883.2.4.4.10' (EZETIMIB/SIMVASTATINE 10/20)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '77038').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '16292|urn:oid:2.16.840.1.113883.2.4.4.10' (ETHINYLESTRADIOL/DESOGESTREL TABLET 30/150UG)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '16292').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '16705|urn:oid:2.16.840.1.113883.2.4.4.10' (Fusidinezuur creme 20mg/g)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '16705').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '42773|urn:oid:2.16.840.1.113883.2.4.4.10' (CODEINE TABLET 10MG (FOSFAAT))"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '42773').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '94692|urn:oid:2.16.840.1.113883.2.4.4.10' (MORFINE INFVLST 5MG/ML CAS 100ML)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '94692').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '44520|urn:oid:2.16.840.1.113883.2.4.4.10' (NITROGLYCERINE PLEISTER 5MG/24UUR (DEPONIT T))"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '44520').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-stopTestOnFail">
               <valueBoolean value="false"/>
            </extension>
            <description value="Confirm that the response Bundle contains 1 Medication resource that contains code '3956|urn:oid:2.16.840.1.113883.2.4.4.10' (ACETYLSALICYLZUUR 100MG TAB)"/>
            <expression value="Bundle.entry.select(resource as Medication).code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '3956').count() = 1"/>
            <sourceId value="transaction-response"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
</TestScript>

<?xml version="1.0" encoding="UTF-8"?>
<nts:component xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript">
    <nts:parameter name="warningOnly" value="true"/>
    <action>
        <assert>
            <description
                value="Confirm that Bundle contains the right address (street) for the {$resource}"/>
            <direction value="{$direction}"/>
            <expression value="Bundle.entry.resource.as({$resource}).address.line.extension.where(url='{$urlstreet}' and value='{$street}')"/>
            <warningOnly value="{$warningOnly}"/>
        </assert>
    </action>
    
    <action>
        <assert>
            <description
                value="Confirm that Bundle contains the right address (house number) for the {$resource}"/>
            <direction value="{$direction}"/>
            <expression value="Bundle.entry.resource.as({$resource}).address.line.extension.where(url='{$urlhousenumber}' and value ='{$housenumber}')"/>
            <warningOnly value="{$warningOnly}"/>
        </assert>
    </action>
    
    <action>
        <assert>
            <description
                value="Confirm that Bundle contains the right city and postal code for the {$resource}"/>
            <direction value="{$direction}"/>
            <expression value="Bundle.entry.resource.as({$resource}).address.where(city='{$city}' and postalCode='{$postalcode}' and use='{$use}')"/>
            <warningOnly value="{$warningOnly}"/>
        </assert>
    </action>
    
    <action>
        <assert>
            <description
                value="Confirm that Bundle contains the right address (type) for the {$resource}"/>
            <direction value="{$direction}"/>
            <expression value="Bundle.entry.resource.as({$resource}).address.extension.where(system='{$urltype}' and valueCodeableConcept.coding.where(system='{$systemtype}' and valueCodeableConcept.coding.code='{$codetype}' and valueCodeableConcept.coding.display.exists()))"/>
            <warningOnly value="{$warningOnly}"/>
        </assert>
    </action>
</nts:component>
<?xml version="1.0" encoding="UTF-8"?>
<!--
    Initialize the eOverdracht Task: create/update the Task on WildFHIR to its initial for the test and set the
    following variables:
    * setup-task-response: The result of the Task create/update operation
    * task-id: The id of the Task
    @param initial-task-fixture-id: The id of the fixture that contains the Task in its initial state (defaults to
                                    "initial-task-fixture").
-->
<nts:component xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript">
    <nts:parameter name="initial-task-fixture-id" value="initial-task-fixture"/>
    
    <variable>
        <name value="task-id" />
        <expression value="Task.id"/>
        <sourceId value="initial-task-fixture"/>
    </variable>
    
    <action>
        <operation>
            <type>
                <system value="http://terminology.hl7.org/CodeSystem/testscript-operation-codes" />
                <code value="updateCreate" />
            </type>
            <resource value="Task" />
            <description nts:ifset="description" value="{$description}"/>
            <description nts:ifnotset="description" value="Set the eOverdracht Task resource to initial status." />
            <accept value="xml" />
            <contentType value="xml" />
            <destination value="1"/>
            <params value="/${task-id}" />
            <nts:include value="header.request.PatientToken" scope="common"/>
            <responseId value="setup-task-response"/>
            <sourceId value="{$initial-task-fixture-id}" />
        </operation>
    </action>
    <nts:include value="assert.response.success" scope="common"/>
</nts:component>

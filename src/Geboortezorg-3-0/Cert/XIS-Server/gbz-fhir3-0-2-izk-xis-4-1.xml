<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="http://hl7.org/fhir/STU3/testscript.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<TestScript xmlns="http://hl7.org/fhir"
            xmlns:nts="http://nictiz.nl/xsl/testscript"
            nts:scenario="server">
   <id value="gbz-fhir3-0-2-ikz-xis-4-1"/>
   <version value="stu3-3.0"/>
   <name value="Nictiz Geboortezorg - Server - Scenario 4.1 - Serve Integrale Zwangerschapskaart resources of fifth pregnancy of Maaike Ostendorf"/>
   <description value="Scenario 4.1: Serve Integrale Zwangerschapskaart resources of fifth pregnancy of Maaike Ostendorf"/>
   <nts:authToken patientResourceId="MAAIKEXXX-Ostendorf"/>
<!--   <variable><name value="episode-id"/><defaultValue value="ca7cf58a-200b-417c-acb5-8aa6a6e692d5"/></variable>-->
   <nts:include value="gbz-variable-episode-id" name="episode-id" sourceId="fixture-5-ServeMaternalRecord"/>
   <variable><name value="T"/><defaultValue value="${CURRENTDATE}"/></variable>
   
   
   <!-- Patient - Zwangere vrouw -->
   <test id="1-ServeWoman">
      <name value="1-ServeWoman"/>
      <description value="Query Patient resource for HCIM Patient"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>         
      </nts:include>   
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-Woman-MAAIKE-M-XXX-OSTENDORF.xml"
                          nts:in-targets="CheckContent"/>
   </test>

    <!-- EpisodeOfCare - zorgepisode zwangerschap -->
   <test id="5-ServeMaternalRecord">
      <name value="5-ServeMaternalRecord"/>
      <description value="Test Server query operation for MaternalRecord (EpisodeOfCare) including managing organization (Organization) and care manager (Practitioner)"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="EpisodeOfCare"/>
         <nts:with-parameter name="params" value="?type=http://snomed.info/sct|364320009&amp;_include=EpisodeOfCare:organization&amp;_include=EpisodeOfCare:care-manager"/>
         <nts:with-parameter name="responseId" value="fixture-5-ServeMaternalRecord"/>
      </nts:include>   
      <nts:include value="assert.response.numResources" scope="common" resource="EpisodeOfCare" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-MaternalRecord-f0eb00a7-6b73-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent"/>
   </test>

   <!-- Conditions - Problemen gerelateerd aan zorgepisode incl. zwangerschap -->
   <test id="6-ServeConditions">
      <name value="6-ServeConditions"/>
      <description value="Test Server query operation for Conditions (including Pregnancy)"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>

       <!-- Zwangerschap --> 
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Zwangerschap)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="118185001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy118185001-565cf23f-6b18-11ec-2334-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=118185001))</nts:discriminator>
      </nts:contentAsserts>
      <!--Urineweginfectie-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(urineweginfectie)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="307534009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DisorderOfPregnancy307534009-b645daeb-6b3a-11ec-2118-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=307534009))</nts:discriminator>
         <nts:discriminator>category.where(coding.code=173300003)</nts:discriminator>
      </nts:contentAsserts>
      <!-- eerstegraads perineumruptuur durante partu -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription"
                             value="(eerstegraads perineumruptuur durante partu)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="57759005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DisorderOfLaborAndDelivery57759005-d570dfa7-6b61-11ec-2156-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=57759005))</nts:discriminator>
      </nts:contentAsserts>
      <!-- toestand van patiënt verslechterd -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(toestand van patiënt verslechterd)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Condition"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="271299001"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DisorderOfLaborAndDelivery271299001-787656c8-6abd-11ec-2156-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=271299001))</nts:discriminator>
      </nts:contentAsserts>
       <!-- Asthma -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(asthma)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="195967001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Problem195967001-1bf63f0f-6aa2-11ec-1291-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=195967001))</nts:discriminator>
      </nts:contentAsserts>
      <!-- pyelonephritis -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pyelonephritis)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="45816000"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Problem45816000-7fa8be61-6b2f-11ec-1291-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=45816000))</nts:discriminator>
      </nts:contentAsserts>
       <!-- colitis ulcerosa -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(colitis ulcerosa)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="64766004"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Problem64766004-06e10132-6b0c-11ec-1291-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=64766004))</nts:discriminator>
      </nts:contentAsserts>
   </test>

    <!-- Encounters -->
   <test id="7-ServeEncounters">
      <name value="7-ServeEncounters"/>
      <description value="Test Server query operation for Encounters"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="params" value="?episodeofcare=EpisodeOfCare/${episode-id}&amp;_include=Encounter:practitioner"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common" resource="Encounter" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>

     
       <!-- Prenatale controle --> 
      <nts:include value="assert.response.numResourcesWithCode" scope="common">
         <nts:with-parameter name="additionalDescription" value="(ContactSoort)"/>
         <nts:with-parameter name="codedElement" value="type"/>
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="11429006"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-Encounter-7b035f27-6b20-11ec-1275-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>type.where(coding.code=11429006)</nts:discriminator>
      </nts:contentAsserts>
   </test>
   
   <!-- Observations - Observaties gekoppeld aan episode -->
   <test id="8a-ServeObservations">
      <name value="8a-ServeObservations"/>
      <description value="Test Server query operation for Observations"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>
       <!-- BMI -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(BMI)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="39156-5"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-MaternalObservation39156-5-1fe6b9a2-6b0b-11ec-2342-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='39156-5'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- lichaamslengte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(lichaamslengte)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>sssss
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="8302-2"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-BodyHeight8302-2-29075b0f-6b4e-11ec-2166-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8302-2'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- pregnancy durations -->
      <!-- 59 dagen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pregnancy duration)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="3"/>
         <nts:with-parameter name="code" value="57036006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy-PregnancyDuration57036006-2ea20e79-6b24-11ec-2702-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='59')</nts:discriminator>
      </nts:contentAsserts>
       <!-- 279 dagen -->
      <nts:contentAsserts href="gz-izv-kwa-casus1/medmij-gbz-zib-Pregnancy-PregnancyDuration-57036006-0a1ff6b2-bc42-4967-b48b-84d333560117.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=57036006))</nts:discriminator>
         <nts:discriminator>value.where(value='279')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy-PregnancyDuration57036006-812c4d63-6aa9-11ec-2334-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=57036006))</nts:discriminator>
         <nts:discriminator>value.where(value='279')</nts:discriminator>
      </nts:contentAsserts>
       <!-- pariteit-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(parity)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="11977-6"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy-Parity11977-6-67c89ac3-6b0f-11ec-2334-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='11977-6'))</nts:discriminator>
      </nts:contentAsserts>
       <!-- Graviditeit -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(gravidity)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="11996-6"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy-Gravidity11996-6-ba5d6097-6b0b-11ec-2334-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='11996-6'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Geschatte a terme datum -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(a terme datum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="161714006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-PregnancyObservation161714006-dbfceeb8-6b47-11ec-2334-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='161714006'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Definitieve a terme datum -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(a terme datum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="147781000146105"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-PregnancyObservation147781000146105-9269ecf3-6b11-11ec-2222-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='147781000146105'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Datum laatste menstruatie-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(a terme datum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="8665-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy-DateLastMenstruation8665-2-3beb7505-6aef-11ec-2335-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8665-2'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- voorgeschiedenis abortus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voorgeschiedenis abortus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="16216731000119106"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-PregnancyObservation16216731000119106-568b74ef-6b1b-11ec-2181-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='16216731000119106'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- aantal levende nakomelingen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(aantal levende nakomelingen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="143881000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-PregnancyObservation143881000146107-c2371ac3-6b52-11ec-2173-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='143881000146107'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- datum einde zwangerschap -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(datum einde zwangerschap)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="118951000146109"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-PregnancyObservation118951000146109-61a10eb8-6aea-11ec-2172-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='118951000146109'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- voorkeur plaats bevalling -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voorkeur plaats bevalling)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="142961000146102"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-MaternalObservation142961000146102-04851afc-6b40-11ec-2225-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='142961000146102'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- tijdstip breken vliezen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tijdstip breken vliezen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="289251005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation289251005-79f3bfeb-6b1b-11ec-2410-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='289251005'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- datum begin actieve ontsluiting -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(datum begin actieve ontsluiting)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="160621000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation160621000146107-454a2d13-6a9c-11ec-2408-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='160621000146107'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- aard vruchtwater -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(aard vruchtwater)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="168089007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation168089007-b3d83f0b-6b76-11ec-2412-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='168089007'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- geboorteplaats-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboorteplaats)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="366344009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-BirthObservation366344009-7ad21437-6a97-11ec-2419-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='366344009'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- type partus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(type partus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364336006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-BirthObservation364336006-fecbefa3-6b67-11ec-2414-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364336006'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- bloedverlies -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloedverlies)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364332008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation364332008-2ed14cf4-6b34-11ec-2396-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364332008'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- ligging kind bij geboorte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(ligging kind bij geboorte)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="271692001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-FetusObservation271692001-5dd887ab-6b2f-11ec-2416-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='271692001'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- tijdstip actief meepersen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tijdstip actief meepersen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249163006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-BirthObservation249163006-5e5b3d16-6ab9-11ec-2413-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='249163006'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- conditie perineum-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(conditie perineum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="609625009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-PerinealAssessment609625009-684ffb15-6aaa-11ec-2395-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='609625009'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- geboorte placenta -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboorte placenta)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236994008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation236994008-2c9c7a0f-6add-11ec-2421-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='236994008'))</nts:discriminator>
      </nts:contentAsserts>
     <!-- Datum en tijd van geboorte placenta -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Datum en tijd van geboorte placenta)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="136311000146100"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation136311000146100-d6fda78b-6aeb-11ec-2423-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='136311000146100'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Compleetheid placenta -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Compleetheid placenta)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364343000"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation364343000-b02d12f7-6b47-11ec-2424-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364343000'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Compleetheid van vruchtvliezen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Compleetheid van vruchtvliezen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364351002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation364351002-ea91873b-6b13-11ec-2427-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364351002'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Aantal bloedvaten in navelstreng -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Aantal bloedvaten in navelstreng)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249191003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation249191003-832a4629-6b23-11ec-2429-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='249191003'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- wijze Begin Baring -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(wijze Begin Baring)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="160611000146102"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryObservation160611000146102-cd876e13-6ab8-11ec-2409-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='160611000146102'))</nts:discriminator>
      </nts:contentAsserts>
   </test>
   
   <!-- Observations - Observaties gekoppeld aan prenatale controle -->
   <test id="8b-ServeObservations">
      <name value="8b-ServeObservations"/>
      <description value="Test Server query operation for Observations"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context:Encounter.episodeofcare=EpisodeOfCare/${episode-id}"/>
      </nts:include>  
      <!-- alcoholgebruik -->
      
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(alcohol use)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="228273003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-AlcoholUse228273003-00b2da4e-6b30-11ec-1212-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='228273003'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- tabak -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tobacco use)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="365980008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-TobaccoUse365980008-edfa0f8f-6b43-11ec-2224-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='365980008'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- drugs -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(drug use)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="228366006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-DrugUse228366006-f3ac1e80-6b09-11ec-1211-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='228366006'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- pregnancy duration-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pregnancy duration)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="57036006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-Pregnancy-PregnancyDuration57036006-2ea20e79-6b24-11ec-2702-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- lichaamsgewicht-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(lichaamsgewicht)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="29463-7"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-BodyWeight29463-7-7365c49b-6ace-11ec-2107-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='29463-7'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- bloeddruk -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloeddruk)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="85354-9"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-zib-BloodPressure85354-9-21f4f183-6aa4-11ec-2106-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='85354-9'))</nts:discriminator>
      </nts:contentAsserts> 
   </test>
   
   <!-- Alle verrichtingen -->
   <test id="9-ServeProcedures">
      <name value="9-ServeProcedures"/>
      <description value="Test Server query operation for (Obstetric) Procedures"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}&amp;_include=Procedure:performer&amp;_include=Procedure:based-on"/>
      </nts:include>   
      <nts:include value="assert.response.numResources" scope="common" resource="Procedure" count="5"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="0"/>
      <nts:include value="assert.response.numResources" scope="common" resource="ProcedureRequest" count="0"/>
      <!-- Verrichting (Bevalling) -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevalling)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236973005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-DeliveryProcedure236973005-44fcd4ef-6b10-11ec-2123-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='236973005'))</nts:discriminator>
      </nts:contentAsserts>
      <!--geboorte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Geboorte)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="3950001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-Birth3950001-e95374d3-6b68-11ec-2123-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='3950001'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- strippen vliezen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Strippen vliezen)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236960006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-ObstetricProcedure236960006-7e6e4e27-6ae1-11ec-2154-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='236960006'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Echografie van foetus-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Echografie van foetus)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="241491007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-ObstetricProcedure241491007-4303593f-6aec-11ec-2119-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='241491007'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- operatie van bewegingsaparaat -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Operatie van bewegingsapparaat)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="112697007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-ObstetricProcedure112697007-07492dbf-6aa7-11ec-2108-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='112697007'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- operatie vrouwelijk geslachtsorgaan-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription"
                             value="(Operatie van vrouwelijk geslachtsorgaan)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="12658000"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-bc-ObstetricProcedure12658000-dbfbda17-6ab3-11ec-2108-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='12658000'))</nts:discriminator>
      </nts:contentAsserts>
   </test>
   
   <!-- Consent -->
   <test id="11-ServeConsent">
      <name value="11-ServeConsent"/>
      <description value="Test Server query operation for Consent"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Consent"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Consent"/>
         <nts:with-parameter name="count" value="1"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1\mm-gbz-bc-TreatmentDirective-c-TreatmentDirective-mm-gbz-ccee86c4-6b5f-11ec-1040-020000000000.xml"
         nts:in-targets="CheckContent"/>
   </test>
   <!-- RelatedPerson --> 
   <test id="12-RelatedPerson">
      <name value="12-RelatedPerson"/>
      <description value="Test Server query operation for RelatedPerson"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="RelatedPerson"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="RelatedPerson"/>
         <nts:with-parameter name="count" value="1"/>
      </nts:include>
      <nts:contentAsserts href="gz-izv-kwa-casus1/mm-gbz-nl-core-relatedperson-relatedperson-mm-gbz-MOHAMMEDMELKADDOURI.xml" 
         nts:in-targets="CheckContent"/>
   </test>
</TestScript>

<?xml version="1.0" encoding="UTF-8"?>
<?xml-model href="http://hl7.org/fhir/STU3/testscript.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<TestScript xmlns="http://hl7.org/fhir"
            xmlns:nts="http://nictiz.nl/xsl/testscript"
            nts:scenario="server">
   <id value="gbz-fhir3-0-2-ikz-xis-4-2"/>
   <version value="stu3-3.0"/>
   <name value="Nictiz Geboortezorg - Server - Scenario 4.2 - Serve Integrale Zwangerschapskaart resources of twin pregnancy of Fiona Swart"/>
   <description value="Scenario 4.2: Serve Integrale Zwangerschapskaart resources of twin pregnancy of Fiona Swart"/>
   <nts:authToken patientResourceId="FIONAXXX-Swart"/>
   <nts:include value="gbz-variable-episode-id" name="episode-id" sourceId="fixture-5-ServeMaternalRecord"/>
   <variable><name value="T"/><defaultValue value="${CURRENTDATE}"/></variable>
   
   <!-- Patient - Zwangere vrouw -->
   <test id="1-ServeWoman">
      <name value="1-ServeWoman"/>
      <description value="Query Patient resource for HCIM Patient"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>         
      </nts:include>   
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-patient-FIONA-F-XXX-SWART.xml" nts:in-targets="CheckContent"/>
   </test>
   
   <!-- Coverage - Verzekeraar -->
   <test id="2-ServePayer">
      <name value="2-ServePayer"/>
      <description value="Query Coverage resource for HCIM Payer"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Coverage"/>         
      </nts:include>  
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Coverage"/>
         <nts:with-parameter name="count" value="0"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- FamilyMemberHistory - Familiegeschiedenis -->
   <test id="3-ServeFamilyMemberHistory">
      <name value="3-ServeFamilyMemberHistory"/>
      <description value="Query FamilyMemberHistory resource for FamilyMemberHistory"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="FamilyMemberHistory"/>         
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="FamilyMemberHistory"/>
         <nts:with-parameter name="count" value="0"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- DeviceUseStatement - Urinekatheter -->
   <test id="4-ServeDeviceUseStatement">
      <name value="4-ServeDeviceUseStatement"/>
      <description value="Query DeviceUseStatement resource for HCIM BladderFunction-UrineCatheter"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="DeviceUseStatement"/>         
         <nts:with-parameter name="params" value="?_include=DeviceUseStatement:device"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="DeviceUseStatement"/>
         <nts:with-parameter name="count" value="0"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- EpisodeOfCare - zorgepisode zwangerschap -->
   <test id="5-ServeMaternalRecord">
      <name value="5-ServeMaternalRecord"/>
      <description value="Test Server query operation for MaternalRecord (EpisodeOfCare) including managing organization (Organization) and care manager (Practitioner)"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="EpisodeOfCare"/>
         <nts:with-parameter name="params" value="?type=http://snomed.info/sct|364320009&amp;_include=EpisodeOfCare:organization&amp;_include=EpisodeOfCare:care-manager"/>
         <nts:with-parameter name="responseId" value="fixture-5-ServeMaternalRecord"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common" resource="EpisodeOfCare" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
      <nts:contentAsserts href="mm-gbz-bc-MaternalRecord-9da7fe7f-6aad-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent"/>
   </test>
   
   <!-- Conditions - Problemen gerelateerd aan zorgepisode incl. zwangerschap -->
   <test id="6-ServeConditions">
      <name value="6-ServeConditions"/>
      <description value="Test Server query operation for Conditions (including Pregnancy)"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>
       <nts:include value="assert.response.numResources" scope="common" resource="Condition" count="4"/>
      <!-- Zwangerschap -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Zwangerschap)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="118185001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy118185001-2f1c3698-6b05-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=118185001))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Meerlingzwangerschap-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(meerlingzwangerschap)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="16356006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-DisorderOfPregnancy-3012b9f2-6b65-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=16356006))</nts:discriminator>
      </nts:contentAsserts>
      <!--Groeiachterstand-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(groeiachterstand)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="22033007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-DisorderOfPregnancy-a8596abc-6aa9-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=22033007))</nts:discriminator>
      </nts:contentAsserts>
      <!-- ligginsafwijken foetus-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(liggingsafwijking foetus)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="15028002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-DisorderOfLaborAndDelivery-e3377364-6b6e-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=15028002))</nts:discriminator>
      </nts:contentAsserts>
   </test>
   
   <!-- Encounters -->
   <test id="7-ServeEncounters">
      <name value="7-ServeEncounters"/>
      <description value="Test Server query operation for Encounters"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="params" value="?episodeofcare=${episode-id}&amp;_include=Encounter:practitioner"/>
      </nts:include> 
      <nts:include value="assert.response.numResources" scope="common" resource="Encounter" count="3"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
      <!-- Prenatale controle -->
      <nts:include value="assert.response.numResourcesWithCode" scope="common">
         <nts:with-parameter name="additionalDescription" value="(ContactSoort)"/>
         <nts:with-parameter name="codedElement" value="type"/>
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="11429006"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-Encounter-c28c144f-6adb-11ec-0000-020000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[0].period.start &lt; Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[1].period.start, Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[0], Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[1])"
         nts:in-targets="CheckContent"/>
      <nts:contentAsserts href="mm-gbz-bc-Encounter-6e831ac7-6a99-11ec-0000-020000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[0].period.start &gt; Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[1].period.start, Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[0], Bundle.entry.resource.ofType(Encounter).where(type.where(coding.code='11429006'))[1])"
         nts:in-targets="CheckContent"/>
      <!-- partusassistentie-->
      <nts:include value="assert.response.numResourcesWithCode" scope="common">
         <nts:with-parameter name="additionalDescription" value="(ContactSoort)"/>
         <nts:with-parameter name="codedElement" value="type"/>
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236973005"/>
      </nts:include>
      <!-- TODO: deze ontbreekt? -->
<!--      <nts:contentAsserts href="bc-ChildBirthAssistance.xml" nts:in-targets="CheckContent">
         <nts:discriminator>type.where(coding.code=236973005)</nts:discriminator>
      </nts:contentAsserts>-->
   </test>
   
   <!-- Observations - Observaties gekoppeld aan episode -->
   <test id="8a-ServeObservations">
      <name value="8a-ServeObservations"/>
      <description value="Test Server query operation for Observations"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
        <!-- <nts:with-parameter name="responseId" value="fixture-8a-ServeObservations"/>-->
      </nts:include>  
      <!-- pregnancy duration -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pregnancy duration)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="57036006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- TODO: extra discriminator toevoegen -->
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-Duration57036006-c33f1923-6a95-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='71')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-Duration57036006-c33f1772-6a95-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='208')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-Duration57036006-c33f1a5a-6a95-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='268')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-Duration57036006-c33f1a31-6a95-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='275')</nts:discriminator>
      </nts:contentAsserts>
      <!-- pariteit-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(parity)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="11977-6"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-Parity11977-6-c33f0030-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='11977-6'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- graviditeit-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(gravidity)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="11996-6"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-Gravidity11996-6-c33f0031-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='11996-6'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- datum laatste menstruatie-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(datum laatste menstruatie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="21840007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-Pregnancy-DateLastMenstruation8665-2-c347dcfc-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='21840007'))</nts:discriminator>
      </nts:contentAsserts>
      <!-- geschatte aterme datum-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geschatte a terme datum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="161714006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation161714006-c33f16b3-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=161714006))</nts:discriminator>
      </nts:contentAsserts>
      <!-- definitieve aterme datum-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(definitieve a terme datum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="147781000146105"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation147781000146105-3ba6c7aa-6abb-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=147781000146105))</nts:discriminator>
      </nts:contentAsserts>
      <!-- foliumzuur intake -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(foliumzuur intake)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="792807003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation792807003-3d7b6861-6aa6-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=792807003))</nts:discriminator>
      </nts:contentAsserts>
      <!-- tweelingzwangerschap-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tweelingzwangerschap)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="65147003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation65147003-867d5ffb-6b46-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=65147003))</nts:discriminator>
      </nts:contentAsserts>
      <!-- aantal levende nakomelingen-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(aantal levende nakomelingen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="143881000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation143881000146107-c3474ba0-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=143881000146107))</nts:discriminator>
      </nts:contentAsserts>
      <!-- geboorteplaats-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboorteplaats)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="366344009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- TODO: 1 gevonden ipv 2 -->
      <nts:contentAsserts href="mm-gbz-nl-core-observation366344009-0627cb95-6ab3-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=366344009))</nts:discriminator>
      </nts:contentAsserts>
      <!-- type partus-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(type partus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="364336006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- expressies worden behoorlijk complex, nog checken of dit simpeler kan door gebruik van een variabele -->
      <!-- TODO: maar 1 gevonden ipv 2 -->
<!--      <nts:contentAsserts href="mm-gbz-nl-core-observation364336006-1869aa18-6aa8-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
<!-\-                          selector="iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[0].effective.toDateTime() &lt; Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[1].effective.toDateTime(), iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0].subject.reference = Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[0].subject.reference, Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[1]),iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0].subject.reference = Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[1].subject.reference, Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[1]))"               
                          nts:in-targets="CheckContent">-\->
      </nts:contentAsserts>-->
<!--      <nts:contentAsserts href="bc-BirthObservation-364336006-f247a6c1-17a8-4aa1-8a36-6e12b114bc52.xml"
                          selector="iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[0].effective.toDateTime() &gt; Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[1].effective.toDateTime(), iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0].subject.reference = Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[0].subject.reference, Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[1]),iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0].subject.reference = Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='8339-4')))[1].subject.reference, Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='364336006')))[1]))"               
                          nts:in-targets="CheckContent">
      </nts:contentAsserts>-->
      <!-- TODO: niet gevonden -->
      <!-- bloeddruk-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloeddruk)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="85354-9"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
<!--      <nts:contentAsserts href="zib-BloodPressure-1e0c641a-e61e-4f38-a51c-04376912a15f.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='85354-9'))</nts:discriminator>
      </nts:contentAsserts>-->
      <!-- geboortegewicht-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboortegewicht)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="8339-4"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation8339-4-68b63688-6b4c-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8339-4'))</nts:discriminator>
         <nts:discriminator>value.where(value='2605')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-nl-core-observation8339-4-71a429f2-6b32-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8339-4'))</nts:discriminator>
         <nts:discriminator>value.where(value='2089')</nts:discriminator>
      </nts:contentAsserts>
      <!-- lichaamslengte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(lichaamslengte)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="8302-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-BodyHeight89269-5-c33f006a-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8302-2'))</nts:discriminator>
         <nts:discriminator>value.where(value='46')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-BodyHeight89269-5-c33f1fb4-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8302-2'))</nts:discriminator>
         <nts:discriminator>value.where(value='48')</nts:discriminator>
      </nts:contentAsserts>
      <!-- apgarscore 1 minuut-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(apgar score 1 minuut)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="9272-6"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-ApgarScore9272-6-c33f0037-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9272-6'))</nts:discriminator>
         <nts:discriminator>value.where(value='7')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-ApgarScore9272-6-c33f0035-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9272-6'))</nts:discriminator>
         <nts:discriminator>value.where(value='5')</nts:discriminator>
      </nts:contentAsserts>
      <!-- apgarscore 5 minuten-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(apgar score 5 minuten)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="9274-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-ApgarScore9274-2-c33f0039-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9274-2'))</nts:discriminator>
         <nts:discriminator>value.where(value='9')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-ApgarScore9274-2-c33f0061-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9274-2'))</nts:discriminator>
         <nts:discriminator>value.where(value='10')</nts:discriminator>
      </nts:contentAsserts>
      <!-- apgarscore 10 minuten-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(apgar score 10 minuten)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="9271-8"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-ApgarScore9271-8-c33f0039-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9271-8'))</nts:discriminator>
         <nts:discriminator>value.where(value='9')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-ApgarScore9271-8-c33f0061-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9271-8'))</nts:discriminator>
         <nts:discriminator>value.where(value='10')</nts:discriminator>
      </nts:contentAsserts>
   	<!-- hoofdomtrek-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(hoofdomtrek)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="9843-4"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-HeadCircumference169876006-c3452040-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9843-4'))</nts:discriminator>
         <nts:discriminator>value.where(value='32.6')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-HeadCircumference169876006-c345596d-6a95-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9843-4'))</nts:discriminator>
         <nts:discriminator>value.where(value='31.8')</nts:discriminator>
      </nts:contentAsserts>
      <!-- TODO: geen lab resultaten gevonden -->
      <!-- rhesus C-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(rhesus c)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="1159-3"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
<!--      <nts:contentAsserts href="zib-LaboratoryTestResult-Observation-1159-3-06ed6450-c247-44c1-ab44-d20bc33bfa46.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='1159-3'))</nts:discriminator>
      </nts:contentAsserts>-->
      <!-- rhesus D-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(rhesus d)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="1305-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
<!--      <nts:contentAsserts href="zib-LaboratoryTestResult-Observation-1305-2-60664465-3eb6-4449-bb30-35737b1fa6c8.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='1305-2'))</nts:discriminator>
      </nts:contentAsserts>-->
      <!-- Bloedgroep-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloedgroep)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="883-9"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
<!--      <nts:contentAsserts href="zib-LaboratoryTestResult-Observation-883-9-aa1ade57-cb5a-4328-9422-10445058d9fa.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='883-9'))</nts:discriminator>
      </nts:contentAsserts>-->
      <!-- hemoglobine-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(hb)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="93846-4"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
<!--      <nts:contentAsserts href="zib-LaboratoryTestResult-Observation-93846-4-39248ef2-a7bd-47e0-8a73-3f5f7a3ddc70.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='93846-4'))</nts:discriminator>
      </nts:contentAsserts>-->
      <!-- Toxoplasma-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(toxoplasma)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="8039-0"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
<!--      <nts:contentAsserts href="zib-LaboratoryTestResult-Observation-8039-0-bf5338b5-c66a-44c6-96fd-bcf846751fda.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8039-0'))</nts:discriminator>
      </nts:contentAsserts>  -->
   </test>
   
   <!-- Observations - Observaties gekoppeld aan prenatale controle -->
   <test id="8b-ServeObservations">
      <name value="8b-ServeObservations"/>
      <description value="Test Server query operation for Observations"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context:Encounter.episodeofcare=EpisodeOfCare/${episode-id}"/>
      </nts:include>    
      <!-- alcoholgebruik -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(alcohol use)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="228273003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-AlcoholUse228273003-c615ffc3-6aa8-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='228273003'))</nts:discriminator>
      </nts:contentAsserts>  
      <!-- tabakgebruik -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tobacco use)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="365980008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- TODO: niet gevonden -->
<!--      <nts:contentAsserts href="zib-TobaccoUse-732cff5e-5bdd-4d9e-9fc0-3916a55b4084.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='365980008'))</nts:discriminator>
      </nts:contentAsserts> -->
      <!-- drugs gebruik-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(drug use)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="228366006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-DrugUse228366006-849a92eb-6b4b-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='228366006'))</nts:discriminator>
      </nts:contentAsserts> 
      <!-- zwangerschapsduur-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pregnancy duration)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="57036006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- TODO: geen observaties gekoppeld aan encounter gevonden -->
<!--      <nts:contentAsserts href="zib-Pregnancy-PregnancyDuration-2b6c4607-9558-4c30-8268-62c9e8b15126.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='73')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="zib-Pregnancy-PregnancyDuration-de0a2492-c9ca-467a-8217-02b15f6ed017.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
         <nts:discriminator>value.where(value='85')</nts:discriminator>
      </nts:contentAsserts>  -->
      <!-- foetale beweging-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(foetale beweging)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364618000"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-nl-core-observation364618000-eb85781f-6a98-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364618000'))</nts:discriminator>
      </nts:contentAsserts>  
      <!-- lichaamsgewicht-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(lichaamsgewicht)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="29463-7"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-zib-BodyWeight29463-7-44f23279-6b13-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='29463-7'))</nts:discriminator>
      </nts:contentAsserts>  
      <!-- bloeddruk -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloeddruk)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="85354-9"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!--todo: deze fhirpath gaat nog niet goed in TouchStone, ondanks dat dit in fhir path tester wel het juiste resultaat geeft -->
      <nts:contentAsserts href="mm-gbz-zib-BloodPressure85354-9-fb87e4d6-6b62-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=85354-9))</nts:discriminator>
         <nts:discriminator>component.where(value.where(value='114'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="mm-gbz-zib-BloodPressure85354-9-b0903a82-6aa5-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=85354-9))</nts:discriminator>
         <nts:discriminator>component.where(value.where(value='108'))</nts:discriminator>
      </nts:contentAsserts>
   </test>
   
   <!-- Alle verrichtingen -->
   <test id="9-ServeProcedures">
      <name value="9-ServeProcedures"/>
      <description value="Test Server query operation for (Obstetric) Procedures"/>
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}&amp;_include=Procedure:performer&amp;_include=Procedure:based-on"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common" resource="Procedure" count="11"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="ProcedureRequest" count="0"/>
      <!-- Verrichting (Bevalling) -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevalling)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236973005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-DeliveryProcedure236973005-823b3241-6b35-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=236973005))</nts:discriminator>
      </nts:contentAsserts>
      <!-- geboorte-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Geboorte)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="3950001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- onderstaande fixtures zijn op subject reference na identiek, er moet nog een oplossing komen om onderscheid te kunnen maken welke bij welk kind hoort, de content assert accepteert maximaal 1 resultaat  -->
      <!-- TODO: maar 1 geboorte? -->
      <!--      <nts:contentAsserts href="mm-gbz-bc-Birth3950001-e773cd78-6b4c-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=3950001))</nts:discriminator>
      </nts:contentAsserts> -->
      <!-- Bloedonderzoek -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bloedonderzoek)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="396550006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-ObstetricProcedure396550006-424ceeac-6b1b-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=396550006))</nts:discriminator>
      </nts:contentAsserts>
      <!-- dieetmanagement-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Dieetmanagement)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="410175003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-ObstetricProcedure410175003-31028d6c-6ad0-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=410175003))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Primaire sectio-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Primaire sectio)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="80771000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- content asserts hieronder-->
      <nts:contentAsserts href="mm-gbz-bc-ObstetricProcedure80771000146107-21f0cab3-6b7b-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=80771000146107))</nts:discriminator>
      </nts:contentAsserts>
      <!-- opname in ziekenhuis-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Opname in ziekenhuis)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="32485007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-ObstetricProcedure32485007-fc138961-6ae7-11ec-0000-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=32485007))</nts:discriminator>
      </nts:contentAsserts>
      <!-- inflatie van long-->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Inflatie van long)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="243140006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <nts:contentAsserts href="mm-gbz-bc-ObstetricProcedure243140006-c8a67ac5-6b56-11ec-0000-020000000000.xml"
                          nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code=243140006))</nts:discriminator>
      </nts:contentAsserts>
      <!-- Vitamine K toediening--> 
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Vitamine K toediening)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="698350008:370131001=133933007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- TODO: maar 1 gevonden -->
      <nts:contentAsserts href="mm-gbz-bc-ObstetricProcedure698350008370131001=133933007-7ac7ac12-6ae9-11ec-0000-020000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[0].performedPeriod.start &lt; Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[1].performedPeriod.start, Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[0], Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[1])"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>
<!--      <nts:contentAsserts href="bc-ObstetricProcedure-698350008=370131001=133933007-9ffbf7df-e7b9-43b1-b77b-ce3b4d2af671.xml"
         selector="iif(Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[0].performedPeriod.start &gt; Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[1].performedPeriod.start, Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[0], Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='698350008:370131001=133933007')))[1])"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>-->
      <!-- onderstaande fixtures zijn op partOf reference na identiek, er moet nog een oplossing komen om onderscheid te kunnen maken welke bij welk kind hoort, de content assert accepteert maximaal 1 resultaat  -->
<!--      <nts:contentAsserts href="bc-ObstetricProcedure-80771000146107-14397ff0-69d1-4025-a992-1f333b661d5e.xml"
                          selector="Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='80771000146107')))[0]"
                          nts:in-targets="CheckContent">
      </nts:contentAsserts>
      <nts:contentAsserts href="bc-ObstetricProcedure-80771000146107-a87cdbdf-787c-4efb-8350-a103cd0f1936.xml"
         selector="Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code='80771000146107')))[1]"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>
         -->
   </test>
   
   <!-- Zorgteam -->
   <test id="10-ServeCareTeam">
      <name value="10-ServeCareTeam"/>
      <description value="Test Server query operation for CareTeam"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="CareTeam"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="CareTeam"/>
         <nts:with-parameter name="count" value="0"/>
      </nts:include>
   </test>
   
   <!-- Consent -->
   <test id="11-ServeConsent">
      <name value="11-ServeConsent"/>
      <description value="Test Server query operation for Consent"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="Consent"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Consent"/>
         <nts:with-parameter name="count" value="0"/>
      </nts:include>
   </test>
   
   <!-- RelatedPerson -->
   <test id="12-RelatedPerson">
      <name value="12-RelatedPerson"/>
      <description value="Test Server query operation for RelatedPerson"/>  
      <nts:include value="medmij/test.xis.successfulSearch" scope="common">
         <nts:with-parameter name="resource" value="RelatedPerson"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="RelatedPerson"/>
         <nts:with-parameter name="count" value="0"/>
      </nts:include>
   </test>
   
</TestScript>

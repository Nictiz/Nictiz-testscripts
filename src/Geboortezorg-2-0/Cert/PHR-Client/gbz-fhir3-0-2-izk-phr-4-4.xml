<?xml-model href="http://hl7.org/fhir/STU3/testscript.sch" type="application/xml" schematypens="http://purl.oclc.org/dsdl/schematron"?>
<TestScript xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript" nts:scenario="client">
   <id value="gbz-fhir3-0-2-ikz-phr-4-4"/>
   <version value="stu3-3.0"/>
   <name value="Nictiz Geboortezorg - Client - Scenario 4.4 - Retrieve Integrale Zwangerschapskaart resources of Wilemijn XXX_Yzendoorn"/>
   <description value="Scenario 4.4: Retrieve Integrale Zwangerschapskaart resources of Wilemijn XXX_Yzendoorn"/>
   <nts:authToken patientResourceId="WILLEMIJN-W-XXX-YZENDOORN-VAN-DEN-XXX-BERG"/>
   <!-- TODO: kan dit op dezelfde manier opgelost worden als voor de XIS scripts of doen we hier hardcoded verwijzing naar de fixture? -->
   <!-- PGO vraagt in principe onze fixtures op, maar dynamische variabele maakt het wel herbruikbaarder deze tests ook met andere server uit te voeren -->
   <nts:fixture id="episodeofcare-fixture" href="mm-gbz-bc-MaternalRecord-14d1a1ff-6b66-11ec-0000-020000000000.xml"/>
   <variable><name value="episode-id"/><expression value="EpisodeOfCare.id"/><sourceId value="episodeofcare-fixture"/></variable>
   <variable><name value="T"/><defaultValue value="${CURRENTDATE}"/></variable>
   
   <!-- Patient - Zwangere vrouw -->
   <test id="1-RetrieveWoman">
      <name value="1-RetrieveWoman"/>
      <description value="Query Patient resource for HCIM Patient"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>         
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- Coverage - Verzekeraar -->
   <test id="2-RetrievePayer">
      <name value="2-RetrievePayer"/>
      <description value="Query Coverage resource for HCIM Payer"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Coverage"/>         
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Coverage"/>
         <nts:with-parameter name="count" value="0"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- FamilyMemberHistory - Familiegeschiedenis -->
   <test id="3-RetrieveFamilyMemberHistory">
      <name value="3-RetrieveFamilyMemberHistory"/>
      <description value="Query FamilyMemberHistory resource for FamilyMemberHistory"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="FamilyMemberHistory"/>         
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="FamilyMemberHistory"/>
         <nts:with-parameter name="count" value="0"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- DeviceUseStatement - Urinekatheter -->
   <test id="4-RetrieveDeviceUseStatement">
      <name value="4-RetrieveDeviceUseStatement"/>
      <description value="Query DeviceUseStatement resource for HCIM BladderFunction-UrineCatheter"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="DeviceUseStatement"/>         
         <nts:with-parameter name="params" value="?_include=DeviceUseStatement:device"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="DeviceUseStatement"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="atLeast"/>
      </nts:include>
   </test>
   
   <!-- EpisodeOfCare - zorgepisode zwangerschap -->
   <test id="5-RetrieveMaternalRecord">
      <name value="5-RetrieveMaternalRecord"/>
      <description value="Test Client query operation for MaternalRecord (EpisodeOfCare) including managing organization (Organization) and care manager (Practitioner)"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="EpisodeOfCare"/>
         <nts:with-parameter name="params" value="?type=http://snomed.info/sct|364320009&amp;_include=EpisodeOfCare:organization&amp;_include=EpisodeOfCare:care-manager"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common" resource="EpisodeOfCare" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
   </test>
   
   <!-- Conditions - Problemen gerelateerd aan zorgepisode incl. zwangerschap -->
   <test id="6-RetrieveConditions">
      <name value="6-RetrieveConditions"/>
      <description value="Test Client query operation for Conditions (including Pregnancy)"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common" resource="Condition" count="6"/>
      <!-- Zwangerschap -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Zwangerschap)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Condition"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="118185001"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Groeiachterstand -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Groeiachterstand)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="22033007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Foetale nood -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Foetale nood)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="288274003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Neonatale hypoglykemie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Neonatale hypoglykemie)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="52767006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Fractuur van clavicula -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Fractuur van clavicula)"/>
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="58150001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
   </test>
   
   <!-- Encounters -->
   <test id="7-RetrieveEncounters">
      <name value="7-RetrieveEncounters"/>
      <description value="Test Client query operation for Encounters"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="params" value="?episodeofcare=${episode-id}&amp;_include=Encounter:practitioner"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common" resource="Encounter" count="3"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
      <!-- Prenatale controle -->
      <nts:include value="assert.response.numResourcesWithCode" scope="common">
         <nts:with-parameter name="additionalDescription" value="(ContactSoort)"></nts:with-parameter>
         <nts:with-parameter name="codedElement" value="type"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Encounter"></nts:with-parameter>
         <nts:with-parameter name="count" value="3"></nts:with-parameter>
         <nts:with-parameter name="code" value="11429006"></nts:with-parameter>
      </nts:include>
   </test>  
   
   <!-- Observations - Observaties gekoppeld aan episode -->  
   <test id="8a-RetrieveObservations">
      <name value="8a-RetrieveObservations"/>
      <description value="Test Client query operation for Observations"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>
      <!-- parity -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(parity)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="11977-6"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- gravidity -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(gravidity)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="11996-6"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- geschatte a terme datum -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geschatte a terme datum)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="161714006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- datum laatste menstruatie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geschatte a terme datum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="8665-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- vaccinatie kinkhoest -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(vaccinatie kinkhoest)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="39343008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- voorgeschiedenis trisomie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voorgeschiedenis trisomie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="390281000146101"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- plaats voorkeur bevalling -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(plaats voorkeur bevalling)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="142961000146102"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- voorgenomen lijn in zorg -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voorgenomen lijn in zorg)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="159821000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- voorgenomen voeding -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voorgenomen voeding)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="169740003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- zorg voor kind -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(zorg voor kind)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="129879003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- hartslag -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(hartslag)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="8893-0"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- urinatie geweest -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(urinatie geweest)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249278006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- lochia -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(lochia)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="2"/>
         <nts:with-parameter name="code" value="249211006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- hoeveelheid lochia -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(hoeveelheid lochia)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="366299003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- stinkende lochia -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(stinkende lochia)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="276375002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- grote bloedstolsels in lochia -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(grote bloedstolsels in lochia)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="146381000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- bevindingen borsten -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bevindingen borsten)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="116339002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- flatusincontinentie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(flatusincontinentie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249508009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- voorlichting anticonceptie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voorlichting anticonceptie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="150811000119101"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- conditie perineum -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(conditie perineum)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364297003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- bloeddruk (nacontrole) -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloeddruk (nacontrole))"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="85354-9"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- voedingspatroon zuigeling -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(voedingspatroon zuigeling)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="289145007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- lichaamstemperatuur -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(lichaamstemperatuur)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="8310-5"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- zwangerschapsduur -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(zwangerschapsduur)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="3"/>
         <nts:with-parameter name="code" value="57036006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- blaasfunctie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(blaasfunctie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="28278009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- darmfunctie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(darmfunctie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="111989001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      
      <!-- foetus -->
      <!-- echo bevindingen algemeen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(echo bevindingen algemeen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="370379002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- buikomtrek -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(buikomtrek)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="11979-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- hoofdomtrek -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(hoofdomtrek)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="363812007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      
      <!-- kind -->
      <!-- feces -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(feces)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249612005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- vitamine K -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(vitamine K)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="698350008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- neonatale sterfte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(neonatale sterfte)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="276506001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- geboortegewicht -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboortegewicht)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="8339-4"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- geboortelengte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboortelengte)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="89269-5"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- Apgar 1 minuut -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Apgar 1 minuut)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="9272-6"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- Apgar 5 minuten -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Apgar 5 minuten)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="9274-2"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- Apgar 10 minuten -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Apgar 10 minuten)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="9271-8"/>
         <nts:with-parameter name="system" value="http://loinc.org"/>
      </nts:include>
      <!-- Bevinding huid -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding huid)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364528001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding hoofd-hals -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding hoofd-hals)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364403006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding thorax -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding thorax)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364434005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding abdomen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding abdomen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364446009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding rug -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding rug)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364415005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding extremiteiten -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding extremiteiten)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="363799009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding genitalia -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding genitalia)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364204002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- Bevinding neurologie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bevinding neurologie)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="363820009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>    
      
      <!-- deze zouden eigenlijk mogelijk aan context Encounter moeten hangen? bevalling -->
      <!-- tijdstip gebroken vliezen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tijdstip gebroken vliezen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="289251005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- vruchtwater -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(vruchtwater)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="366334007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- type partus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(type partus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="366334007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- ligging kind -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(ligging kind)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="271692001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- plaats baring -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(plaats baring)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="366344009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- geboorte placenta -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboorte placenta)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236994008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- tijdstip geboorte placenta -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tijdstip geboorte placenta)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="136311000146100"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- compleetheid placenta -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(compleetheid placenta)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364343000"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- placenta PA -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(placenta PA)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="168123008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- testuitslag PA -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(testuitslag PA)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="726566009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- vruchtvliezen -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(vruchtvliezen)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364351002"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- navelstreng -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(navelstreng)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249191003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- bloedverlies -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bloedverlies)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364332008"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- datum begin eerste fase partus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(datum begin eerste fase partus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="160621000146107"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- wijze begin eerste fase partus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(wijze begin eerste fase partus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="160611000146102"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
   </test>
   
   <!-- Observations - Observaties gekoppeld aan prenatale controle -->  
   <test id="8b-RetrieveObservations">
      <name value="8b-RetrieveObservations"/>
      <description value="Test Client query operation for Observations"/>  
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context:Encounter.episodeofcare=EpisodeOfCare/${episode-id}"/>
      </nts:include>
      <!-- bewegingspatroon foetus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bewegingspatroon foetus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364618000"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- hoogte uterus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(hoogte uterus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364265003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- ligging foetus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(ligging foetus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="249062004"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- indaling foetus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(indaling foetus)"/>
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="364611006"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
   </test>
   
   <!-- Alle verrichtingen -->
   <test id="9-RetrieveProcedures">
      <name value="9-RetrieveProcedures"/>
      <description value="Test Client query operation for (Obstetric) Procedures"/>
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}&amp;_include=Procedure:performer&amp;_include=Procedure:based-on"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common" resource="Procedure" count="6"/>
<!--      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="0"/>
      <nts:include value="assert.response.numResources" scope="common" resource="ProcedureRequest" count="0"/>-->
      <!-- echografie foetus -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(echografie foetus)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="241491007"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- bevalling -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(bevalling)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="236973005"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- vaginaal toucher -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(vaginaal toucher)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="51597003"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- sectio -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(sectio)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="80801000146105"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- prenatale risico evaluatie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(ligging foetus)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="713076009"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
      <!-- geboorte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(geboorte)"/>
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="count" value="1"/>
         <nts:with-parameter name="code" value="3950001"/>
         <nts:with-parameter name="system" value="http://snomed.info/sct"/>
      </nts:include>
   </test>
   
   <!-- Zorgteam -->
   <test id="10-RetrieveCareTeam">
      <name value="10-RetrieveCareTeam"/>
      <description value="Test Client query operation for CareTeam"/>  
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="CareTeam"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${episode-id}"/>
      </nts:include>
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="CareTeam"/>
         <nts:with-parameter name="count" value="0"/>
      </nts:include>
   </test>
   
   <!-- Consent -->
   <test id="11-RetrieveConsent">
      <name value="11-RetrieveConsent"/>
      <description value="Test Client query operation for Consent"/>  
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="Consent"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Consent"/>
         <nts:with-parameter name="count" value="0"/>
      </nts:include>
   </test>
   
   <!-- RelatedPerson -->
   <test id="12-RelatedPerson">
      <name value="12-RelatedPerson"/>
      <description value="Test Client query operation for RelatedPerson"/>  
      <nts:include value="medmij/test.phr.successfulsearch" scope="common">
         <nts:with-parameter name="resource" value="RelatedPerson"/>
      </nts:include>    
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="RelatedPerson"/>
         <nts:with-parameter name="count" value="2"/>
      </nts:include>
   </test>   
   
</TestScript>

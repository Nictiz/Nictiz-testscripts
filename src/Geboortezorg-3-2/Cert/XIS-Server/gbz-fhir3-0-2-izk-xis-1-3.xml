<?xml version="1.0" encoding="UTF-8"?><!-- in this script content asserts are commented out since it becomes very complicated with multiple fixtures having the same code and same structure, the content asserts for the same resources are already available in test 1.1 and 1.2, for 2.0 release consider removing this script entirely since most vendors prefer using script 1.1 and 1.2 -->
<TestScript xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript" nts:scenario="server">
   <id value="gbz-fhir3-0-2-ikz-xis-1-3"/>
   <version value="stu3-3.0"/>
   <name value="Nictiz Geboortezorg - Server - Scenario 1.3 - Serve Integrale Zwangerschapskaart resources of all pregnancies of Hanna Kooij"/>
   <description value="Scenario 1.3: Serve Integrale Zwangerschapskaart resources of all pregnancies of Hanna Kooij"/>
   <nts:authToken patientResourceId="HANNAHXXX-KOOIJ"/>
   <variable><name value="dossier1-id"/><defaultValue value="0d479b8b-2063-11ec-1751-020000000000"/></variable>
   <variable><name value="dossier2-id"/><defaultValue value="d735bfeb-2062-11ec-2089-020000000000"/></variable>
   <variable><name value="T"/><defaultValue value="${CURRENTDATE}"/></variable>
   
   <!-- Patient - Zwangere vrouw -->
   <test id="1-ServeWoman">
      <name value="1-ServeWoman"/>
      <description value="Test Server query operation for HCIM Patient"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="Patient"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/> 
      <nts:include value="assert.response.numResources" scope="common">
         <nts:with-parameter name="resource" value="Patient"/>
         <nts:with-parameter name="count" value="1"/>
      </nts:include><!--
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-nl-core-patient-HANNAHXXX-KOOIJ.xml"
         nts:in-targets="CheckContent"/>-->
   </test>

   <!-- Voorgaande zwangerschap (dossier) -->
   <test id="2-ServeMaternalRecord">
      <name value="2-ServeMaternalRecord"/>
      <description value="Test Server query operation for MaternalRecord (EpisodeOfCare) including managing organization (Organization) and care manager (Practitioner)"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="EpisodeOfCare"/>
         <nts:with-parameter name="params" value="?type=http://snomed.info/sct|364320009&amp;_include=EpisodeOfCare:organization&amp;_include=EpisodeOfCare:care-manager"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/>     <nts:include value="assert.response.queryParamsInSelfLink" scope="common"/>
      <nts:include value="assert.response.numResources" scope="common" resource="EpisodeOfCare" count="2"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="1"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
<!--      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-MaternalRecord-0d479b8b-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>status='active'</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-MaternalRecord-d735bfeb-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>status='finished')</nts:discriminator>
      </nts:contentAsserts>-->
   </test>
    
   <!-- Conditions - Problemen gerelateerd aan dossier incl. zwangerschap -->
   <test id="3-ServeConditions">
      <name value="3-ServeConditions"/>
      <description value="Test Server query operation for for Conditions (including Pregnancy))"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="Condition"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${dossier1-id},EpisodeOfCare/${dossier2-id}"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/>     <nts:include value="assert.response.queryParamsInSelfLink" scope="common"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Condition" count="5"/>
      <!-- Zwangerschap -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Zwangerschap)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Condition"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="118185001"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Zwakke foetale beweging -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Zwakke foetale beweging)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Condition"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="276372004"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Niet vorderende uitdrijving -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Niet vorderende uitdrijving)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Condition"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="249166003"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Foetale nood -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Foetale nood)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Condition"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="288274003"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
<!--      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-Pregnancy118185001-0d47afc5-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='118185001'))</nts:discriminator>
         <nts:discriminator>clinicalStatus='inactive')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-Pregnancy118185001-d735d436-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='118185001'))</nts:discriminator>
         <nts:discriminator>clinicalStatus='active')</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-DisorderOfPregnancy276372004-0d47b511-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='276372004'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-DisorderOfLaborAndDelivery249166003-d835d977-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='249166003'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-DisorderOfLaborAndDelivery288274003-d735d977-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='288274003'))</nts:discriminator>
      </nts:contentAsserts>-->
   </test>
    
   <!-- Prenatale controles -->
   <test id="4-ServePrenatalVisits">
      <name value="4-ServePrenatalVisits"/>
      <description value="Test Server query operation for PrenatalVisits (Encounter)"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="Encounter"/>
         <nts:with-parameter name="params" value="?episodeofcare=${dossier1-id},${dossier2-id}&amp;_include=Encounter:practitioner"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/>     <nts:include value="assert.response.queryParamsInSelfLink" scope="common"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Encounter" count="3"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Practitioner" count="1"/>
      <nts:include value="assert.response.numResourcesWithCode" scope="common">
         <nts:with-parameter name="additionalDescription" value="(ContactSoort)"></nts:with-parameter>
         <nts:with-parameter name="codedElement" value="type"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Encounter"></nts:with-parameter>
         <nts:with-parameter name="count" value="3"></nts:with-parameter>
         <nts:with-parameter name="code" value="11429006"></nts:with-parameter>
      </nts:include>
      <!-- TODO add discriminator -->
<!--      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-Encounter-0d47afdc-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent"/>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-Encounter-0d47afea-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent"/>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-Encounter-0d47afdc-2063-11ec-1749-020000000000.xml"
         nts:in-targets="CheckContent"/>-->
   </test>  
   
   <!-- Observations - Observaties gekoppeld aan dossier -->  
   <test id="5a-ServeObservations">
      <name value="5a-ServeObservations"/>
      <description value="Test Server query operation for Observations"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${dossier1-id},EpisodeOfCare/${dossier2-id}"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/>     <nts:include value="assert.response.queryParamsInSelfLink" scope="common"/> 
      <!-- pregnancy duration -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pregnancy duration)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="57036006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- parity -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(parity)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="11977-6"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- gravidity -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(gravidity)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="11996-6"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- term date -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(term date)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="161714006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- date last menstruation -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(date last menstruation)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="21840007"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- def term date -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(def term date)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="147781000146105"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- number of living offspring -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(number of living offspring)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="143881000146107"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- folium accid intake -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(folium accid intake)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="792807003"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- onset first stage of labor -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(onset first stage of labor)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="160621000146107"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- type first stage of labor -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(type first stage of labor)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="160611000146102"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- parturition type -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(parturition type)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="364336006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- number of offspring -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(number of offspring)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="118861000146102"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- place of birth -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(place of birth)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="169812000"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Lab rhesus D -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Rhesus D)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="1305-2"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Lab rhesus C -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Rhesus C)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="1159-3"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Bloedgroep -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Bloedgroep)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="883-9"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Apgar Score 1-minuut -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Apgar Score 1-minuut)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="9272-6"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Apgar Score 5-minuten -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Apgar Score 5-minuten)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="9274-2"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Apgar Score 10-minuten -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Apgar Score 10-minuten)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="9271-8"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Geboortegewicht -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Geboortegewicht)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="8339-4"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Lichaamslengte bij geboorte -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Geboortelengte)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="89269-5"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- Hoofdomtrek -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Hoofdomtrek)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="169876006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
<!--      <!-\- TODO add discriminator for first 6 obs -\->
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-PregnancyObservation161714006-0d47afc9-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='161714006'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-PregnancyObservation161714006-0d47afc9-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='161714006'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-PregnancyObservation147781000146105-0d47afce-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='147781000146105'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-PregnancyObservation147781000146105-0d47afce-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='147781000146105'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-PregnancyObservation143881000146107-0d47afd2-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='143881000146107'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-MaternalObservation792807003-0d47afdb-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='792807003'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-LaboratoryTestResult-Observation1305-2-0d47a3b4-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='1305-2'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-LaboratoryTestResult-Observation1159-3-0d47a576-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='1159-3'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-LaboratoryTestResult-Observation883-9-0d47a1f2-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='883-9'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-Pregnancy-Parity364325004-d735d437-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='11977-6'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-Pregnancy-Gravidity161732006-d735d438-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='11996-6'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-Pregnancy-DateLastMenstruation21840007-1da0e1e1-8fdf-11ec-2025-030000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='21840007'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/edmij-gbz-bc-Pregnancy-PregnancyDuration57036006-a4809bb6-2291-11ec-8669-030000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='57036006'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-DeliveryObservation160621000146107-d735d446-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='160621000146107'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-DeliveryObservation160611000146102-d735d44b-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='160611000146102'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-BirthObservation364336006-d735d96f-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364336006'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-DeliveryObservation118861000146102-d735d972-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='118861000146102'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-BirthObservation169812000-d735d974-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='169812000'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-ApgarScore9272-6-d735d98e-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9272-6'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-9274-2-d735d990-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9274-2'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-9271-8-d735d992-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='9271-8'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-ChildObservation8339-4-d735d986-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='8339-4'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-BodyHeight89269-5-d735d988-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='89269-5'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-HeadCircumference169876006-d735d98a-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='169876006'))</nts:discriminator>
      </nts:contentAsserts>-->
   </test>
   
   <!-- Observations - Observaties gekoppeld aan prenatale controle -->  
   <test id="5b-ServeObservations">
      <name value="5b-ServeObservations"/>
      <description value="Test Server query operation for Observations"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="Observation"/>
         <nts:with-parameter name="params" value="?context:Encounter.episodeofcare=EpisodeOfCare/${dossier1-id},EpisodeOfCare/${dossier2-id}"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/>     <nts:include value="assert.response.queryParamsInSelfLink" scope="common"/>
      <!-- pregnancy duration -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(pregnancy duration)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="2"></nts:with-parameter>
         <nts:with-parameter name="code" value="57036006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- fetal movement -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(fetal movement)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="364618000"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- body weight -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(body weight)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="3"></nts:with-parameter>
         <nts:with-parameter name="code" value="29463-7"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include> 
      <!-- blood pressure -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(blood pressure)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="3"></nts:with-parameter>
         <nts:with-parameter name="code" value="85354-9"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://loinc.org"></nts:with-parameter>
      </nts:include>
      <!-- alcohol use -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(alcohol use)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="228273003"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- drug use -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(drug use)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="228366006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- tobacco use -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(tobacco use)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Observation"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="365980008"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
<!--      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-Pregnancy-PregnancyDuration57036006-a4907bc6-2293-11ec-8779-030000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[0].effective.toDateTime() &lt; Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[1].effective.toDateTime(), Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[1])"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-Pregnancy-PregnancyDuration57036006-a4907bc6-2291-11ec-8779-030000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[0].effective.toDateTime() &gt; Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[1].effective.toDateTime(), Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='57036006')))[1])"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-PregnancyObservation364618000-0d47aff1-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='364618000'))</nts:discriminator>
      </nts:contentAsserts>
      <!-\- TODO add discriminators -\->
<!-\-      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-BodyWeight29463-7-0d47b535-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='29463-7'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-BodyWeight29463-7-0d47b53b-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='29463-7'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-BodyWeight29463-7-0d47b535-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='29463-7'))</nts:discriminator>
      </nts:contentAsserts>-\->
<!-\-      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-BloodPressure85354-9-0d47b531-2063-11ec-1751-020000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[0].effective.toDateTime() &lt; Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[1].effective.toDateTime(), Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[1])"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-BloodPressure85354-9-0d47b537-2063-11ec-1751-020000000000.xml"
         selector="iif(Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[0].effective.toDateTime() &gt; Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[1].effective.toDateTime(), Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[0], Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code='85354-9')))[1])"
         nts:in-targets="CheckContent">
      </nts:contentAsserts>-\->
<!-\-      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-zib-BloodPressure85354-9-d735d995-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='85354-9'))</nts:discriminator>
      </nts:contentAsserts>-\->
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-AlcoholUse228273003-0d47afe5-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='228273003'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-DrugUse228366006-0d47afe7-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='228366006'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-zib-TobaccoUse365980008-0d47afe9-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='365980008'))</nts:discriminator>
      </nts:contentAsserts>-->
   </test>
   
   <!-- Procedures - Verrichtingen gekoppeld aan dossier -->
   <test id="6-ServeProcedures">
      <name value="6-ServeProcedures"/>
      <description value="Test Server query operation for Procedures"/>
      <nts:include value="gbz-operation-search-xis">
         <nts:with-parameter name="resource" value="Procedure"/>
         <nts:with-parameter name="params" value="?context=EpisodeOfCare/${dossier1-id},EpisodeOfCare/${dossier2-id}&amp;_include=Procedure:performer&amp;_include=Procedure:based-on"/>
      </nts:include>
      <nts:include value="assert.request.authorizationHeader" scope="common"/>
      <nts:include value="medmij/assert.response.successfulSearch" scope="common" resource="Bundle"/>     <nts:include value="assert.response.queryParamsInSelfLink" scope="common"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Procedure" count="6" atLeast="true"/>
      <nts:include value="assert.response.numResources" scope="common" resource="Organization" count="0"/>
      <nts:include value="assert.response.numResources" scope="common" resource="ProcedureRequest" count="0"/>
      <!-- Delivery -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Delivery)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="236973005"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!--   todo: voor nu nemen we gegevens kind niet mee, wellicht in aparte test ivm afwijkend subject -->
      <!-- Birth -->
      <!--      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Birth)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="3950001"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>-->
      <!-- Episiotomie -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Episiotomie)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="114961000146100"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Vaginaal toucher -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Vaginaal Toucher)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="51597003"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Foetale hartslag monitoring -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Foetale hartslag monitoring)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="281568006"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Echo -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Echo)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="241491007"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
      <!-- Educatiemateriaal -->
      <nts:include value="gbz-assert-returnCountWithCode">
         <nts:with-parameter name="additionalDescription" value="(Educatiemateriaal)"></nts:with-parameter>
         <nts:with-parameter name="resource" value="Procedure"></nts:with-parameter>
         <nts:with-parameter name="count" value="1"></nts:with-parameter>
         <nts:with-parameter name="code" value="445283009"></nts:with-parameter>
         <nts:with-parameter name="system" value="http://snomed.info/sct"></nts:with-parameter>
      </nts:include>
<!--      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-ObstetricProcedure281568006-0d47b51d-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='281568006'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-ObstetricProcedure241491007-0d47b516-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='241491007'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart1/medmij-gbz-bc-ObstetricProcedure445283009-0d47b519-2063-11ec-1751-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='445283009'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-DeliveryProcedure236973005-d735d441-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='236973005'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-ObstetricProcedure114961000146100-d735d451-2062-11ec-2089-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='114961000146100'))</nts:discriminator>
      </nts:contentAsserts>
      <nts:contentAsserts href="Vrouw1-Kaart2/medmij-gbz-bc-ObstetricProcedure51597003-da260877-4e9b-11ec-4587-020000000000.xml"
         nts:in-targets="CheckContent">
         <nts:discriminator>code.where(coding.where(code='51597003'))</nts:discriminator>
      </nts:contentAsserts>-->
   </test>
    
</TestScript>

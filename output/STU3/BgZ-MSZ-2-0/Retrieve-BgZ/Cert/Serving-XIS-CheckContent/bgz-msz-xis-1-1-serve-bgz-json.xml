<?xml version="1.0" encoding="UTF-8"?>
<TestScript xmlns="http://hl7.org/fhir" xmlns:nts="http://nictiz.nl/xsl/testscript">
   <id value="bgz-msz-xis-1-1-serve-bgz-CheckContent-json"/>
   <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-rule">
      <extension url="ruleId">
         <valueId value="assert-response-queryParamsInSelfLink"/>
      </extension>
      <extension url="path">
         <valueString value="../_reference/rules/assert_response_queryParamsInSelfLink.groovy"/>
      </extension>
   </extension>
   <url value="http://nictiz.nl/fhir/TestScript/bgz-msz-xis-1-1-serve-bgz-CheckContent-json"/>
   <version value="stu3-3.0-patchlevel 2025.31"/>
   <name value="BgZ MSZ - Serving XIS - Scenario 1.1 - Serve BgZ resources of J Houten - target CheckContent - JSON Format"/>
   <status value="active"/>
   <publisher value="Nictiz"/>
   <contact>
      <name value="Nictiz"/>
      <telecom>
         <system value="email"/>
         <value value="kwalificatie@nictiz.nl"/>
         <use value="work"/>
      </telecom>
   </contact>
   <description value="Scenario 1.1 - Serve BgZ resources of J Houten"/>
   <origin>
      <extension url="http://fhir.interoplab.eu/fhir/StructureDefinition/Interoplab-CL-ext-SUT">
         <valueBoolean value="false"/>
      </extension>
      <index value="1"/>
      <profile>
         <system value="http://terminology.hl7.org/CodeSystem/testscript-profile-origin-types"/>
         <code value="FHIR-Client"/>
      </profile>
   </origin>
   <destination>
      <extension url="http://fhir.interoplab.eu/fhir/StructureDefinition/Interoplab-CL-ext-SUT">
         <valueBoolean value="true"/>
      </extension>
      <index value="1"/>
      <profile>
         <system value="http://terminology.hl7.org/CodeSystem/testscript-profile-destination-types"/>
         <code value="FHIR-Server"/>
      </profile>
   </destination>
   <profile id="Bundle-profile"
            value="http://hl7.org/fhir/StructureDefinition/Bundle"/>
   <variable>
      <name value="patient-token-id"/>
      <defaultValue value="Bearer 2ecadd10-f520-49aa-bb29-551120325ec7"/>
      <description value="OAuth Token for current patient"/>
   </variable>
   <variable>
      <name value="JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id"/>
      <description value="Resource.id for Patient 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).id'-->
      <expression value="Bundle.entry.resource.where($this is Patient).id"/>
      <sourceId value="fixture-01-serve-Patient"/>
   </variable>
   <variable>
      <name value="nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id"/>
      <description value="Resource.id for Practitioner 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).id'-->
      <expression value="Bundle.entry.resource.where($this is Practitioner).id"/>
      <sourceId value="fixture-01-serve-Patient"/>
   </variable>
   <variable>
      <name value="zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id"/>
      <description value="Resource.id for Coverage 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).id'-->
      <expression value="Bundle.entry.resource.where($this is Coverage).id"/>
      <sourceId value="fixture-02-serve-Payer"/>
   </variable>
   <variable>
      <name value="nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id"/>
      <description value="Resource.id for Organization 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).id'-->
      <expression value="Bundle.entry.resource.where($this is Organization).id"/>
      <sourceId value="fixture-02-serve-Payer"/>
   </variable>
   <variable>
      <name value="zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id"/>
      <description value="Resource.id for Consent 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).id'-->
      <expression value="Bundle.entry.resource.where($this is Consent).id"/>
      <sourceId value="fixture-03-serve-TreatmentDirective"/>
   </variable>
   <variable>
      <name value="zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id"/>
      <description value="Resource.id for Consent 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).id'-->
      <expression value="Bundle.entry.resource.where($this is Consent).id"/>
      <sourceId value="fixture-04-serve-AdvanceDirective"/>
   </variable>
   <variable>
      <name value="BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '15188001'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '15188001'))).id"/>
      <sourceId value="fixture-05-serve-FunctionalOrMentalStatus"/>
   </variable>
   <variable>
      <name value="BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '301438001'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '301438001'))).id"/>
      <sourceId value="fixture-05-serve-FunctionalOrMentalStatus"/>
   </variable>
   <variable>
      <name value="BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 3"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '366979004'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '366979004'))).id"/>
      <sourceId value="fixture-05-serve-FunctionalOrMentalStatus"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '16114001'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '16114001'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').where(valueCode.where($this = 'OTH')))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').where(valueCode.where($this = 'OTH')))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 3"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '428220001'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '428220001'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 4"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '193570009'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '193570009'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 5"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '193570009'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '193570009'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 6"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '239872002'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '239872002'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 7"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '49526009'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '49526009'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 8"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '2421000146101'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '2421000146101'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 9"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '68496003'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '68496003'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 10"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '31641000146105'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '31641000146105'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id"/>
      <description value="Resource.id for Condition 11"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '204609007'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '204609007'))).id"/>
      <sourceId value="fixture-06-serve-Problem"/>
   </variable>
   <variable>
      <name value="zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).id"/>
      <sourceId value="fixture-07-serve-LivingSituation"/>
   </variable>
   <variable>
      <name value="zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(valueCodeableConcept.where(coding.where(code = '361055000'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(valueCodeableConcept.where(coding.where(code = '361055000'))).id"/>
      <sourceId value="fixture-08-serve-DrugUse"/>
   </variable>
   <variable>
      <name value="zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(valueCodeableConcept.where(coding.where(code = '44870007'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(valueCodeableConcept.where(coding.where(code = '44870007'))).id"/>
      <sourceId value="fixture-08-serve-DrugUse"/>
   </variable>
   <variable>
      <name value="zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).id"/>
      <sourceId value="fixture-09-serve-AlcoholUse"/>
   </variable>
   <variable>
      <name value="zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).id"/>
      <sourceId value="fixture-10-serve-TobaccoUse"/>
   </variable>
   <variable>
      <name value="zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id"/>
      <description value="Resource.id for NutritionOrder 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(oralDiet.where(type.where(text = 'Groenten en fruit'))).id'-->
      <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(oralDiet.where(type.where(text = 'Groenten en fruit'))).id"/>
      <sourceId value="fixture-11-serve-NutritionAdvice"/>
   </variable>
   <variable>
      <name value="zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id"/>
      <description value="Resource.id for NutritionOrder 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(oralDiet.where(type.where(text = 'Eiwitrijk voedsel'))).id'-->
      <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(oralDiet.where(type.where(text = 'Eiwitrijk voedsel'))).id"/>
      <sourceId value="fixture-11-serve-NutritionAdvice"/>
   </variable>
   <variable>
      <name value="zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id"/>
      <description value="Resource.id for Flag 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(code.where(coding.where(code = 'OTH'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Flag).where(code.where(coding.where(code = 'OTH'))).id"/>
      <sourceId value="fixture-12-serve-Alert"/>
   </variable>
   <variable>
      <name value="zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id"/>
      <description value="Resource.id for Flag 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(code.where(coding.where(code = '432415000'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Flag).where(code.where(coding.where(code = '432415000'))).id"/>
      <sourceId value="fixture-12-serve-Alert"/>
   </variable>
   <variable>
      <name value="zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id"/>
      <description value="Resource.id for AllergyIntolerance 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '764146007'))).id'-->
      <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '764146007'))).id"/>
      <sourceId value="fixture-13-serve-AllergyIntolerance"/>
   </variable>
   <variable>
      <name value="zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id"/>
      <description value="Resource.id for AllergyIntolerance 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '13577000'))).id'-->
      <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '13577000'))).id"/>
      <sourceId value="fixture-13-serve-AllergyIntolerance"/>
   </variable>
   <variable>
      <name value="zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id"/>
      <description value="Resource.id for AllergyIntolerance 3"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '111088007'))).id'-->
      <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '111088007'))).id"/>
      <sourceId value="fixture-13-serve-AllergyIntolerance"/>
   </variable>
   <variable>
      <name value="zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id"/>
      <description value="Resource.id for MedicationStatement 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id'-->
      <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id"/>
      <sourceId value="fixture-14-serve-MedicationUse"/>
   </variable>
   <variable>
      <name value="zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id"/>
      <description value="Resource.id for MedicationStatement 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id'-->
      <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id"/>
      <sourceId value="fixture-14-serve-MedicationUse"/>
   </variable>
   <variable>
      <name value="zib-Product-msz-1aa30579-6b58-11ec-0000-2-id"/>
      <description value="Resource.id for Medication 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '67903'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '67903'))).id"/>
      <sourceId value="fixture-14-serve-MedicationUse"/>
   </variable>
   <variable>
      <name value="zib-Product-msz-33e35a59-6b47-11ec-0000-2-id"/>
      <description value="Resource.id for Medication 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '35475'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '35475'))).id"/>
      <sourceId value="fixture-14-serve-MedicationUse"/>
   </variable>
   <variable>
      <name value="zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id"/>
      <description value="Resource.id for MedicationRequest 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id'-->
      <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id"/>
      <sourceId value="fixture-15-serve-MedicationAgreement"/>
   </variable>
   <variable>
      <name value="zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id"/>
      <description value="Resource.id for MedicationRequest 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id'-->
      <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id"/>
      <sourceId value="fixture-15-serve-MedicationAgreement"/>
   </variable>
   <variable>
      <name value="zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id"/>
      <description value="Resource.id for MedicationDispense 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '2456451'))).id'-->
      <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '2456451'))).id"/>
      <sourceId value="fixture-16-serve-AdministrationAgreement"/>
   </variable>
   <variable>
      <name value="zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id"/>
      <description value="Resource.id for MedicationDispense 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '1112740'))).id'-->
      <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '1112740'))).id"/>
      <sourceId value="fixture-16-serve-AdministrationAgreement"/>
   </variable>
   <variable>
      <name value="zib-Product-msz-ed64af2f-6b27-11ec-0000-2-id"/>
      <description value="Resource.id for Medication 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '2456451'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '2456451'))).id"/>
      <sourceId value="fixture-16-serve-AdministrationAgreement"/>
   </variable>
   <variable>
      <name value="zib-Product-msz-ad7d7eef-6b2d-11ec-0000-2-id"/>
      <description value="Resource.id for Medication 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '1112740'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '1112740'))).id"/>
      <sourceId value="fixture-16-serve-AdministrationAgreement"/>
   </variable>
   <variable>
      <name value="zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id"/>
      <description value="Resource.id for DeviceUseStatement 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '466193006'))).id'-->
      <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '466193006'))).id"/>
      <sourceId value="fixture-17-serve-MedicalDevice"/>
   </variable>
   <variable>
      <name value="zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id"/>
      <description value="Resource.id for DeviceUseStatement 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '360283003'))).id'-->
      <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '360283003'))).id"/>
      <sourceId value="fixture-17-serve-MedicalDevice"/>
   </variable>
   <variable>
      <name value="zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id"/>
      <description value="Resource.id for Device 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(type.where(coding.where(code = '466193006'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Device).where(type.where(coding.where(code = '466193006'))).id"/>
      <sourceId value="fixture-17-serve-MedicalDevice"/>
   </variable>
   <variable>
      <name value="zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id"/>
      <description value="Resource.id for Device 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(type.where(coding.where(code = '360283003'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Device).where(type.where(coding.where(code = '360283003'))).id"/>
      <sourceId value="fixture-17-serve-MedicalDevice"/>
   </variable>
   <variable>
      <name value="zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id"/>
      <description value="Resource.id for Immunization 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(vaccineCode.where(coding.where(code = 'J07BC20'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Immunization).where(vaccineCode.where(coding.where(code = 'J07BC20'))).id"/>
      <sourceId value="fixture-18-serve-Vaccination"/>
   </variable>
   <variable>
      <name value="zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id"/>
      <description value="Resource.id for Immunization 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(vaccineCode.where(coding.where(code = 'J07AM01'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Immunization).where(vaccineCode.where(coding.where(code = 'J07AM01'))).id"/>
      <sourceId value="fixture-18-serve-Vaccination"/>
   </variable>
   <variable>
      <name value="zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).id"/>
      <sourceId value="fixture-19-serve-BloodPressure"/>
   </variable>
   <variable>
      <name value="zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).id"/>
      <sourceId value="fixture-20-serve-BodyWeight"/>
   </variable>
   <variable>
      <name value="zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).id"/>
      <sourceId value="fixture-21-serve-BodyHeight"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59260-0')) and value.ofType(Quantity).value = 10.9).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59260-0')) and value.where($this is Quantity).value = 10.9).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59468-9')) and value.ofType(Quantity).value = 1.9).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59468-9')) and value.where($this is Quantity).value = 1.9).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 3"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '58410-2'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '58410-2'))).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 4"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '4544-3')) and value.ofType(Quantity).value = 0.50).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '4544-3')) and value.where($this is Quantity).value = 0.50).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 5"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59467-1')) and value.ofType(Quantity).value = 23).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59467-1')) and value.where($this is Quantity).value = 23).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 6"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '6690-2')) and value.ofType(Quantity).value = 10.60).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '6690-2')) and value.where($this is Quantity).value = 10.60).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 7"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '777-3')) and value.ofType(Quantity).value = 320).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '777-3')) and value.where($this is Quantity).value = 320).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 8"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '787-2')) and value.ofType(Quantity).value = 95).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '787-2')) and value.where($this is Quantity).value = 95).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id"/>
      <description value="Resource.id for Observation 9"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '789-8')) and value.ofType(Quantity).value = 5.2).id'-->
      <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '789-8')) and value.where($this is Quantity).value = 5.2).id"/>
      <sourceId value="fixture-22-serve-LaboratoryTestResult"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '71917006'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '71917006'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '73761001'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '73761001'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 3"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '404628003'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '404628003'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 4"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '1251645009'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '1251645009'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 5"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '447304001'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '447304001'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 6"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '239613002'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '239613002'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id"/>
      <description value="Resource.id for Procedure 7"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '62181000146108'))).id'-->
      <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '62181000146108'))).id"/>
      <sourceId value="fixture-23-serve-Procedure"/>
   </variable>
   <variable>
      <name value="zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id"/>
      <description value="Resource.id for Encounter 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(class.code = 'EMER').id'-->
      <expression value="Bundle.entry.resource.where($this is Encounter).where(class.code = 'EMER').id"/>
      <sourceId value="fixture-24-serve-Contact"/>
   </variable>
   <variable>
      <name value="zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id"/>
      <description value="Resource.id for Encounter 2"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(class.code = 'IMP').id'-->
      <expression value="Bundle.entry.resource.where($this is Encounter).where(class.code = 'IMP').id"/>
      <sourceId value="fixture-24-serve-Contact"/>
   </variable>
   <variable>
      <name value="nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id"/>
      <description value="Resource.id for CareTeam 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).id'-->
      <expression value="Bundle.entry.resource.where($this is CareTeam).id"/>
      <sourceId value="fixture-27-serve-Careteam"/>
   </variable>
   <variable>
      <name value="BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id"/>
      <description value="Resource.id for Provenance 1"/>
      <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).id'-->
      <expression value="Bundle.entry.resource.where($this is Provenance).id"/>
      <sourceId value="fixture-27-serve-Provenance"/>
   </variable>
   <test id="01-serve-Patient">
      <name value="Scenario 1.1 - Patient"/>
      <description value="Serve Patient resource including the patient's general practitioner for HCIM Patient"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Patient"/>
            <description value="Test Server to serve Patient resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;_include=Patient:general-practitioner"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-01-serve-Patient"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Patient - Check Patient"/>
      <description value="Check if the previous operation results in a FHIR Patient that contains the values that are expected following Nictiz' materials (fixture .id: JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Patient"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Patient).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Patient resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Patient'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Patient').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Patient').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .identifier with .system and .value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').identifier.where(system and value).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').identifier.where(system and value).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .name with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-assembly-order' with .valueCode 'NL1' and .family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value, and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR', and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN', and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(extension('http://hl7.org/fhir/StructureDefinition/humanname-assembly-order').value.ofType(code) = 'NL1' and family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(extension('http://hl7.org/fhir/StructureDefinition/humanname-assembly-order').value.where($this is code) = 'NL1' and family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-1"/>
            <description value="Contains .name.extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-assembly-order' with .valueCode 'NL1'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(extension('http://hl7.org/fhir/StructureDefinition/humanname-assembly-order').value.ofType(code) = 'NL1').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(extension('http://hl7.org/fhir/StructureDefinition/humanname-assembly-order').value.where($this is code) = 'NL1').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2"/>
            <description value="Contains .name.family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2-1"/>
            <description value="Contains .name.family with a value. This assert checks only one child. Assert 1-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(family.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(family.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2-2"/>
            <description value="Contains .name.family.extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value. This assert checks only one child. Assert 1-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2-3"/>
            <description value="Contains .name.family.extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value. This assert checks only one child. Assert 1-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-3"/>
            <description value="Contains .name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-3-1"/>
            <description value="Contains .name.given with a value. This assert checks only one child. Assert 1-3-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-3-2"/>
            <description value="Contains .name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR'. This assert checks only one child. Assert 1-3-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-4"/>
            <description value="Contains .name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-4-1"/>
            <description value="Contains .name.given with a value. This assert checks only one child. Assert 1-3-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-4-2"/>
            <description value="Contains .name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN'. This assert checks only one child. Assert 1-3-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-5"/>
            <description value="Contains .name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-5-1"/>
            <description value="Contains .name.given with a value. This assert checks only one child. Assert 1-3-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-5-2"/>
            <description value="Contains .name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-3-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .telecom with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'MC' and .display and .system 'phone', and .value with a value, and .use 'home'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display) and system = 'phone' and value.hasValue() and use = 'home').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display) and system = 'phone' and value.hasValue() and use = 'home').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-1"/>
            <description value="Contains .telecom.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'MC' and .display. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-2"/>
            <description value="Contains .telecom.system 'phone'. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(system = 'phone').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(system = 'phone').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-3"/>
            <description value="Contains .telecom.value with a value. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(value.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(value.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-4"/>
            <description value="Contains .telecom.use 'home'. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(use = 'home').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(use = 'home').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .telecom with .system 'email', and .value with a value, and .use 'home'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(system = 'email' and value.hasValue() and use = 'home').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(system = 'email' and value.hasValue() and use = 'home').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-1"/>
            <description value="Contains .telecom.system 'email'. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(system = 'email').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(system = 'email').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-2"/>
            <description value="Contains .telecom.value with a value. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(value.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(value.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-3"/>
            <description value="Contains .telecom.use 'home'. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').telecom.where(use = 'home').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').telecom.where(use = 'home').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .gender 'male' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AdministrativeGender' and .code 'M' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').gender.where($this = 'male' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AdministrativeGender' and code = 'M' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').gender.where($this = 'male' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AdministrativeGender' and code = 'M' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-1"/>
            <description value="Contains .gender 'male'. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').gender = 'male''-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').gender = 'male'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-2"/>
            <description value="Contains .gender.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AdministrativeGender' and .code 'M' and .display. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').gender.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AdministrativeGender' and code = 'M' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').gender.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AdministrativeGender' and code = 'M' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .birthDate"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').birthDate.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').birthDate.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .deceasedBoolean 'false'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').deceased.ofType(boolean) = false'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').deceased.where($this is boolean) = false"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .address with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'PHYS' and .display and .use 'home', and .type 'physical', and .line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID' with .valueString with a value, and .city with a value, and .postalCode with a value, and .country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display) and use = 'home' and type = 'physical' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID').value.ofType(string).hasValue()) and city.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display))).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display) and use = 'home' and type = 'physical' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID').value.where($this is string).hasValue()) and city.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display))).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-1"/>
            <description value="Contains .address.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'PHYS' and .display. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-2"/>
            <description value="Contains .address.use 'home'. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(use = 'home').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(use = 'home').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-3"/>
            <description value="Contains .address.type 'physical'. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(type = 'physical').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(type = 'physical').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-4"/>
            <description value="Contains .address.line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID' with .valueString with a value. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-4-1"/>
            <description value="Contains .address.line with a value. This assert checks only one child. Assert 1-9-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(line.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(line.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-4-2"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value. This assert checks only one child. Assert 1-9-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-4-3"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value. This assert checks only one child. Assert 1-9-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-4-4"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID' with .valueString with a value. This assert checks only one child. Assert 1-9-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-unitID').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-5"/>
            <description value="Contains .address.city with a value. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(city.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(city.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-6"/>
            <description value="Contains .address.postalCode with a value. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(postalCode.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(postalCode.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-7"/>
            <description value="Contains .address.country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-7-1"/>
            <description value="Contains .address.country with a value. This assert checks only one child. Assert 1-9-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(country.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(country.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-7-2"/>
            <description value="Contains .address.country.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-9-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').address.where(country.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').address.where(country.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .multipleBirthBoolean 'false'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').multipleBirth.ofType(boolean) = false'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').multipleBirth.where($this is boolean) = false"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11"/>
            <description value="Contains .contact with .relationship with .coding with .system 'http://hl7.org/fhir/v3/RoleCode' and .code 'SONC' and .display, and .relationship with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.22.472' and .code '1' and .display, and .name with .family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR' and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN' and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL', and .telecom with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'MC' and .display and .system 'phone' and .value with a value and .use 'home', and .telecom with .system 'email' and .value with a value and .use 'home', and .address with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'PHYS' and .display and .use 'home' and .type 'physical' and .line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value and .city with a value and .postalCode with a value and .country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(relationship.where(coding.where(system = 'http://hl7.org/fhir/v3/RoleCode' and code = 'SONC' and display)) and relationship.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.22.472' and code = '1' and display)) and name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')) and telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display) and system = 'phone' and value.hasValue() and use = 'home') and telecom.where(system = 'email' and value.hasValue() and use = 'home') and address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display) and use = 'home' and type = 'physical' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue()) and city.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)))).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(relationship.where(coding.where(system = 'http://hl7.org/fhir/v3/RoleCode' and code = 'SONC' and display)) and relationship.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.22.472' and code = '1' and display)) and name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')) and telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display) and system = 'phone' and value.hasValue() and use = 'home') and telecom.where(system = 'email' and value.hasValue() and use = 'home') and address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display) and use = 'home' and type = 'physical' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue()) and city.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)))).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-1"/>
            <description value="Contains .contact.relationship with .coding with .system 'http://hl7.org/fhir/v3/RoleCode' and .code 'SONC' and .display. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(relationship.where(coding.where(system = 'http://hl7.org/fhir/v3/RoleCode' and code = 'SONC' and display)).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(relationship.where(coding.where(system = 'http://hl7.org/fhir/v3/RoleCode' and code = 'SONC' and display)).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-2"/>
            <description value="Contains .contact.relationship with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.22.472' and .code '1' and .display. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(relationship.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.22.472' and code = '1' and display)).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(relationship.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.22.472' and code = '1' and display)).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3"/>
            <description value="Contains .contact.name with .family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value, and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR', and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN', and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-1"/>
            <description value="Contains .contact.name.family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value. This assert checks only one child. Assert 1-11-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-1-1"/>
            <description value="Contains .contact.name.family with a value. This assert checks only one child. Assert 1-11-3-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.family.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.family.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-1-2"/>
            <description value="Contains .contact.name.family.extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-prefix' with .valueString with a value. This assert checks only one child. Assert 1-11-3-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-prefix').value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-1-3"/>
            <description value="Contains .contact.name.family.extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value. This assert checks only one child. Assert 1-11-3-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-2"/>
            <description value="Contains .contact.name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR'. This assert checks only one child. Assert 1-11-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-2-1"/>
            <description value="Contains .contact.name.given with a value. This assert checks only one child. Assert 1-11-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-2-2"/>
            <description value="Contains .contact.name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR'. This assert checks only one child. Assert 1-11-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-3"/>
            <description value="Contains .contact.name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN'. This assert checks only one child. Assert 1-11-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-3-1"/>
            <description value="Contains .contact.name.given with a value. This assert checks only one child. Assert 1-11-3-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-3-2"/>
            <description value="Contains .contact.name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN'. This assert checks only one child. Assert 1-11-3-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-4"/>
            <description value="Contains .contact.name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-11-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-4-1"/>
            <description value="Contains .contact.name.given with a value. This assert checks only one child. Assert 1-11-3-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-3-4-2"/>
            <description value="Contains .contact.name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-11-3-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(name.given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(name.given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-4"/>
            <description value="Contains .contact.telecom with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'MC' and .display and .system 'phone', and .value with a value, and .use 'home'. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display) and system = 'phone' and value.hasValue() and use = 'home').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display) and system = 'phone' and value.hasValue() and use = 'home').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-4-1"/>
            <description value="Contains .contact.telecom.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'MC' and .display. This assert checks only one child. Assert 1-11-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display).exists())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'MC' and display).exists())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-4-2"/>
            <description value="Contains .contact.telecom.system 'phone'. This assert checks only one child. Assert 1-11-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(system = 'phone')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(system = 'phone')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-4-3"/>
            <description value="Contains .contact.telecom.value with a value. This assert checks only one child. Assert 1-11-4 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(value.hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(value.hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-4-4"/>
            <description value="Contains .contact.telecom.use 'home'. This assert checks only one child. Assert 1-11-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(use = 'home')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(use = 'home')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-5"/>
            <description value="Contains .contact.telecom with .system 'email', and .value with a value, and .use 'home'. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(system = 'email' and value.hasValue() and use = 'home').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(system = 'email' and value.hasValue() and use = 'home').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-5-1"/>
            <description value="Contains .contact.telecom.system 'email'. This assert checks only one child. Assert 1-11-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(system = 'email')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(system = 'email')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-5-2"/>
            <description value="Contains .contact.telecom.value with a value. This assert checks only one child. Assert 1-11-5 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(value.hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(value.hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-5-3"/>
            <description value="Contains .contact.telecom.use 'home'. This assert checks only one child. Assert 1-11-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(telecom.where(use = 'home')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(telecom.where(use = 'home')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6"/>
            <description value="Contains .contact.address with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'PHYS' and .display and .use 'home', and .type 'physical', and .line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value, and .city with a value, and .postalCode with a value, and .country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display) and use = 'home' and type = 'physical' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue()) and city.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display))).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display) and use = 'home' and type = 'physical' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue()) and city.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display))).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-1"/>
            <description value="Contains .contact.address.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'PHYS' and .display. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'PHYS' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-2"/>
            <description value="Contains .contact.address.use 'home'. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.use = 'home').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.use = 'home').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-3"/>
            <description value="Contains .contact.address.type 'physical'. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.type = 'physical').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.type = 'physical').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-4"/>
            <description value="Contains .contact.address.line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-4-1"/>
            <description value="Contains .contact.address.line with a value. This assert checks only one child. Assert 1-11-6-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.line.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.line.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-4-2"/>
            <description value="Contains .contact.address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value. This assert checks only one child. Assert 1-11-6-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-4-3"/>
            <description value="Contains .contact.address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value. This assert checks only one child. Assert 1-11-6-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-4-4"/>
            <description value="Contains .contact.address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value. This assert checks only one child. Assert 1-11-6-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-5"/>
            <description value="Contains .contact.address.city with a value. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.city.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.city.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-6"/>
            <description value="Contains .contact.address.postalCode with a value. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.postalCode.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.postalCode.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-7"/>
            <description value="Contains .contact.address.country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-11-6 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-7-1"/>
            <description value="Contains .contact.address.country with a value. This assert checks only one child. Assert 1-11-6-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.country.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.country.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-6-7-2"/>
            <description value="Contains .contact.address.country.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-11-6-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').contact.where(address.country.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').contact.where(address.country.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-12"/>
            <description value="Contains .generalPractitioner with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference' with .valueReference with either .reference or .identifier and .display, and with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').generalPractitioner.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.ofType(Reference).where((reference or identifier) and display) and (reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').generalPractitioner.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.where($this is Reference).where((reference or identifier) and display) and (reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-12-1"/>
            <description value="Contains .generalPractitioner.extension with url 'http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference' with .valueReference with either .reference or .identifier and .display. This assert checks only one child. Assert 1-12 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').generalPractitioner.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.ofType(Reference).where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').generalPractitioner.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.where($this is Reference).where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-12-1"/>
            <description value="Contains .generalPractitioner with either .reference or .identifier and .display. This assert checks only one child. Assert 1-12 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Patient).where(id = '${JAN-ADRIANUS-J-A-H- -JAN-VAN-HOUTEN-id}').generalPractitioner.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Patient).where(id = '${JAN-ADRIANUS-J-A-H--JAN-VAN-HOUTEN-id}').generalPractitioner.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Patient - Check Practitioner"/>
      <description value="Check if the previous operation results in a FHIR Practitioner that contains the values that are expected following Nictiz' materials (fixture .id: nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Practitioner"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Practitioner resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://fhir.nl/fhir/StructureDefinition/nl-core-practitioner'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').meta.profile.where($this = 'http://fhir.nl/fhir/StructureDefinition/nl-core-practitioner').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').meta.profile.where($this = 'http://fhir.nl/fhir/StructureDefinition/nl-core-practitioner').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .identifier with .system and .value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').identifier.where(system and value).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').identifier.where(system and value).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .name with .family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value, and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR', and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN', and .given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()) and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN') and given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-1"/>
            <description value="Contains .name.family with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-1-1"/>
            <description value="Contains .name.family with a value. This assert checks only one child. Assert 1-3-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-1-2"/>
            <description value="Contains .name.family.extension with url 'http://hl7.org/fhir/StructureDefinition/humanname-own-name' with .valueString with a value. This assert checks only one child. Assert 1-3-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(family.extension('http://hl7.org/fhir/StructureDefinition/humanname-own-name').value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2"/>
            <description value="Contains .name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2-1"/>
            <description value="Contains .name.given with a value. This assert checks only one child. Assert 1-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-2-2"/>
            <description value="Contains .name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'BR'. This assert checks only one child. Assert 1-3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'BR')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'BR')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-3"/>
            <description value="Contains .name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-3-1"/>
            <description value="Contains .name.given with a value. This assert checks only one child. Assert 1-3-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-3-2"/>
            <description value="Contains .name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'IN'. This assert checks only one child. Assert 1-3-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'IN')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'IN')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-4"/>
            <description value="Contains .name.given with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-3 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-4-1"/>
            <description value="Contains .name.given with a value. This assert checks only one child. Assert 1-3-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3-4-2"/>
            <description value="Contains .name.given.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier' with .valueCode 'CL'. This assert checks only one child. Assert 1-3-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.ofType(code) = 'CL')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').name.where(given.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier').value.where($this is code) = 'CL')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .telecom with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and .code 'LL' and .display and .system 'phone', and .value with a value, and .use 'work'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display) and system = 'phone' and value.hasValue() and use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display) and system = 'phone' and value.hasValue() and use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-1"/>
            <description value="Contains .telecom.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and .code 'LL' and .display. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-2"/>
            <description value="Contains .telecom.system 'phone'. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(system = 'phone').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(system = 'phone').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-3"/>
            <description value="Contains .telecom.value with a value. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(value.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(value.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-4"/>
            <description value="Contains .telecom.use 'work'. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .telecom with .system 'email', and .value with a value, and .use 'work'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(system = 'email' and value.hasValue() and use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(system = 'email' and value.hasValue() and use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-1"/>
            <description value="Contains .telecom.system 'email'. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(system = 'email').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(system = 'email').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-2"/>
            <description value="Contains .telecom.value with a value. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(value.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(value.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-3"/>
            <description value="Contains .telecom.use 'work'. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').telecom.where(use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .address with .line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value, and .city with a value, and .postalCode with a value. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue()) and city.hasValue() and postalCode.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue()) and city.hasValue() and postalCode.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-1"/>
            <description value="Contains .address.line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-1-1"/>
            <description value="Contains .address.line with a value. This assert checks only one child. Assert 1-6-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-1-2"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value. This assert checks only one child. Assert 1-6-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-1-3"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value. This assert checks only one child. Assert 1-6-1 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-2"/>
            <description value="Contains .address.city with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(city.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(city.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-3"/>
            <description value="Contains .address.postalCode with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(postalCode.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Practitioner).where(id = '${nl-core-practitioner-msz-2-16-840-1-113883-2-4-6-1-10000001-id}').address.where(postalCode.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test id="02-serve-Payer">
      <name value="Scenario 1.1 - Payer"/>
      <description value="Serve Coverage resource(s) including the insurer for HCIM Payer"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Coverage"/>
            <description value="Test Server to serve Coverage resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?beneficiary.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;_include=Coverage:payor"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-02-serve-Payer"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Payer - Check Coverage"/>
      <description value="Check if the previous operation results in a FHIR Coverage that contains the values that are expected following Nictiz' materials (fixture .id: zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Coverage"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Coverage resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Payer'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Payer').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Payer').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .type with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.101.5.1' and .code 'A' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').type.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.101.5.1' and code = 'A' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').type.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.101.5.1' and code = 'A' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .subscriber with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').subscriber.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').subscriber.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subscriberId with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').subscriberId.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').subscriberId.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .beneficiary with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').beneficiary.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').beneficiary.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .period with .start and .end"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').period.where(start and end).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').period.where(start and end).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .payor with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').payor.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Coverage).where(id = '${zib-Payer-msz-5857e409-6b3d-11ec-0000-2-1-id}').payor.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Payer - Check Organization"/>
      <description value="Check if the previous operation results in a FHIR Organization that contains the values that are expected following Nictiz' materials (fixture .id: nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Organization"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Organization).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Organization resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://fhir.nl/fhir/StructureDefinition/nl-core-organization'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').meta.profile.where($this = 'http://fhir.nl/fhir/StructureDefinition/nl-core-organization').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').meta.profile.where($this = 'http://fhir.nl/fhir/StructureDefinition/nl-core-organization').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .identifier with .system and .value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').identifier.where(system and value).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').identifier.where(system and value).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .name with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').name.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').name.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .telecom with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and .code 'LL' and .display and .system 'phone', and .value with a value, and .use 'work'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display) and system = 'phone' and value.hasValue() and use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display) and system = 'phone' and value.hasValue() and use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-1"/>
            <description value="Contains .telecom.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and .code 'LL' and .display. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-ContactInformation-TelecomType').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.22.1' and code = 'LL' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-2"/>
            <description value="Contains .telecom.system 'phone'. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(system = 'phone').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(system = 'phone').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-3"/>
            <description value="Contains .telecom.value with a value. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(value.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(value.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-4"/>
            <description value="Contains .telecom.use 'work'. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .telecom with .system 'email', and .value with a value, and .use 'work'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(system = 'email' and value.hasValue() and use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(system = 'email' and value.hasValue() and use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-1"/>
            <description value="Contains .telecom.system 'email'. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(system = 'email').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(system = 'email').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-2"/>
            <description value="Contains .telecom.value with a value. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(value.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(value.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-3"/>
            <description value="Contains .telecom.use 'work'. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').telecom.where(use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .address with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'WP' and .display and .use 'work', and .line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value, and .city with a value, and .district with a value, and .postalCode with a value, and .country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'WP' and display) and use = 'work' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue()) and city.hasValue() and district.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display))).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'WP' and display) and use = 'work' and line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue()) and city.hasValue() and district.hasValue() and postalCode.hasValue() and country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display))).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-1"/>
            <description value="Contains .address.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/AddressUse' and .code 'WP' and .display. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'WP' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-AddressInformation-AddressType').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/AddressUse' and code = 'WP' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-2"/>
            <description value="Contains .address.use 'work'. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(use = 'work').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(use = 'work').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-3"/>
            <description value="Contains .address.line with a value and with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value and .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where($this.hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue() and extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-3-1"/>
            <description value="Contains .address.line with a value. This assert checks only one child. Assert 1-6-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where($this.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where($this.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-3-2"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName' with .valueString with a value. This assert checks only one child. Assert 1-6-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-streetName').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-3-3"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber' with .valueString with a value. This assert checks only one child. Assert 1-6-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-houseNumber').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-3-4"/>
            <description value="Contains .address.line.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator' with .valueString with a value. This assert checks only one child. Assert 1-6-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.ofType(string).hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(line.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-ADXP-additionalLocator').value.where($this is string).hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-4"/>
            <description value="Contains .address.city with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(city.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(city.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-5"/>
            <description value="Contains .address.district with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(district.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(district.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-6"/>
            <description value="Contains .address.postalCode with a value. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(postalCode.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(postalCode.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-7"/>
            <description value="Contains .address.country with a value and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-6 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(country.where($this.hasValue() and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display)).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-7-1"/>
            <description value="Contains .address.country with a value. This assert checks only one child. Assert 1-6-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(country.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(country.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6-7-2"/>
            <description value="Contains .address.country.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:iso:std:iso:3166' and .version and .code 'NL' and .display. This assert checks only one child. Assert 1-6-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(country.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Organization).where(id = '${nl-core-organization-msz-2-16-840-1-113883-2-4-6-4-1900-id}').address.where(country.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:iso:std:iso:3166' and version and code = 'NL' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test id="03-serve-TreatmentDirective">
      <name value="Scenario 1.1 - TreatmentDirective"/>
      <description value="Serve Consent resource(s) for HCIM TreatmentDirective"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Consent"/>
            <description value="Test Server to serve Consent resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=http://snomed.info/sct|11291000146105"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-03-serve-TreatmentDirective"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - TreatmentDirective - Check Consent"/>
      <description value="Check if the previous operation results in a FHIR Consent that contains the values that are expected following Nictiz' materials (fixture .id: zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Consent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Consent).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Consent resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification' with .extension with url 'Verified' with .valueBoolean 'true' and .extension with url 'VerifiedWith' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '116154003' and .display and .extension with url 'VerificationDate' with .valueDateTime. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').where(extension('Verified').value.ofType(boolean) = true and extension('VerifiedWith').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '116154003' and display) and extension('VerificationDate').value.ofType(dateTime)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').where(extension('Verified').value.where($this is boolean) = true and extension('VerifiedWith').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '116154003' and display) and extension('VerificationDate').value.where($this is dateTime)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-1"/>
            <description value="Contains .extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension with url 'Verified' with .valueBoolean 'true'. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension('Verified').value.ofType(boolean) = true'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension('Verified').value.where($this is boolean) = true"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-2"/>
            <description value="Contains .extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension with url 'VerifiedWith' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '116154003' and .display. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension('VerifiedWith').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '116154003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension('VerifiedWith').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '116154003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-3"/>
            <description value="Contains .extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension with url 'VerificationDate' with .valueDateTime. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension('VerificationDate').value.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Verification').extension('VerificationDate').value.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Treatment' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Treatment').value.ofType(CodeableConcept).where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Treatment').value.where($this is CodeableConcept).where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .modifierExtension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-TreatmentPermitted' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4' and .code 'JA_MAAR' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').modifierExtension.where(url = 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-TreatmentPermitted').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4' and code = 'JA_MAAR' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').modifierExtension.where(url = 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-TreatmentPermitted').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4' and code = 'JA_MAAR' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '11291000146105' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '11291000146105' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '11291000146105' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .sourceReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').source.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').source.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .policy with .uri"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').policy.where(uri).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').policy.where(uri).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .except with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Restrictions' with .valueString with a value and .type 'deny'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').except.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Restrictions').value.ofType(string).hasValue() and type = 'deny').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').except.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Restrictions').value.where($this is string).hasValue() and type = 'deny').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-1"/>
            <description value="Contains .except.extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Restrictions' with .valueString with a value. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').except.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Restrictions').value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').except.where(extension('http://nictiz.nl/fhir/StructureDefinition/zib-TreatmentDirective-Restrictions').value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-2"/>
            <description value="Contains .except.type 'deny'. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').except.where(type = 'deny').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-TreatmentDirective-msz-b8dec329-6b1f-11ec-0000-2-id}').except.where(type = 'deny').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="04-serve-AdvanceDirective">
      <name value="Scenario 1.1 - AdvanceDirective"/>
      <description value="Serve Consent resource(s) for HCIM AdvanceDirective"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Consent"/>
            <description value="Test Server to serve Consent resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=http://snomed.info/sct|11341000146107"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-04-serve-AdvanceDirective"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AdvanceDirective - Check Consent"/>
      <description value="Check if the previous operation results in a FHIR Consent that contains the values that are expected following Nictiz' materials (fixture .id: zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Consent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Consent).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Consent resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AdvanceDirective'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AdvanceDirective').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AdvanceDirective').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/Comment' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/Comment').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/Comment').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '11341000146107' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '11341000146107' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '11341000146107' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .category with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.14.1' and .code 'LW' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').category.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.14.1' and code = 'LW' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').category.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.14.1' and code = 'LW' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .dateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').dateTime.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').dateTime.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .sourceAttachment with .contentType and with either .data or .url"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').source.ofType(Attachment).where(contentType and (data or url)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').source.where($this is Attachment).where(contentType and (data or url)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .policy with .uri"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').policy.where(uri).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Consent).where(id = '${zib-AdvanceDirective-msz-9297ac71-6b2e-11ec-0000-2-id}').policy.where(uri).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="05-serve-FunctionalOrMentalStatus">
      <name value="Scenario 1.1 - FunctionalOrMentalStatus"/>
      <description value="Serve Observation resource(s) for HCIM FunctionalOrMentalStatus"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=http://snomed.info/sct|118228005,http://snomed.info/sct|384821006"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-05-serve-FunctionalOrMentalStatus"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - FunctionalOrMentalStatus - Check Observation 1"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '15188001'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '15188001'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '15188001'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '15188001'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '15188001'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-FunctionalOrMentalStatus-MedicalDevice' with .valueReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-FunctionalOrMentalStatus-MedicalDevice').value.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-FunctionalOrMentalStatus-MedicalDevice').value.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '118228005' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '118228005' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '118228005' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '15188001' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '15188001' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '15188001' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .effectivePeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').effective.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').effective.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '255604002' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255604002' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-7d454781-6b40-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255604002' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - FunctionalOrMentalStatus - Check Observation 2"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '301438001'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '301438001'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '301438001'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '301438001'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '301438001'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '118228005' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '118228005' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '118228005' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '301438001' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '301438001' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '301438001' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .effectivePeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').effective.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').effective.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '255604002' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255604002' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255604002' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-e224232f-6b22-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - FunctionalOrMentalStatus - Check Observation 3"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '366979004'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '366979004'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '366979004'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '366979004'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '366979004'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-FunctionalOrMentalStatus').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '384821006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '384821006' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '384821006' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '366979004' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '366979004' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '366979004' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-6"/>
            <description value="Contains .effectivePeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').effective.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').effective.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-7"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24484000' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24484000' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24484000' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-8"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${BgZ-FuncMentStat-msz-094b70ae-6b0c-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test id="06-serve-Problem">
      <name value="Scenario 1.1 - Problem"/>
      <description value="Serve Condition resource(s) for HCIM Problem"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Condition"/>
            <description value="Test Server to serve Condition resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-06-serve-Problem"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 1"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '16114001'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '16114001'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '16114001'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '16114001'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '16114001'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '282291009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with and .coding with .system 'http://snomed.info/sct' and .code '16114001' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').code.where( and coding.where(system = 'http://snomed.info/sct' and code = '16114001' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').code.where( and coding.where(system = 'http://snomed.info/sct' and code = '16114001' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4-1"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '16114001' and .display. This assert checks only one child. Assert 1-4 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').code.where(coding.where(system = 'http://snomed.info/sct' and code = '16114001' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').code.where(coding.where(system = 'http://snomed.info/sct' and code = '16114001' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display and .coding with .system 'http://snomed.info/sct' and .code '30021000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display) and coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display) and coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-1"/>
            <description value="Contains .bodySite.extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5-1"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '30021000' and .display. This assert checks only one child. Assert 1-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4c1fb8c9-6b65-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 2"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.extension:valueCode = 'OTH'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').where(valueCode.where($this = 'OTH')))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').where(valueCode.where($this = 'OTH')))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').where(valueCode.where($this = 'OTH')))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').where(valueCode.where($this = 'OTH')))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 2-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 2-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .code with .extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor' with .valueCode 'OTH' and .text with a value. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').code.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').value.ofType(code) = 'OTH' and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').code.where(extension('http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').value.where($this is code) = 'OTH' and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3-1"/>
            <description value="Contains .code.extension with url 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor' with .valueCode 'OTH'. This assert checks only one child. Assert 2-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').code.extension('http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').value.ofType(code) = 'OTH''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').code.extension('http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').value.where($this is code) = 'OTH'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3-1"/>
            <description value="Contains .code with .text with a value. This assert checks only one child. Assert 2-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').code.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').code.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-7b1afca2-6b54-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 3"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '428220001'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '428220001'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '428220001'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '428220001'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '428220001'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '282291009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '428220001' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '428220001' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '428220001' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display and .coding with .system 'http://snomed.info/sct' and .code '30021000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display) and coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display) and coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5-1"/>
            <description value="Contains .bodySite.extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks only one child. Assert 3-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5-1"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '30021000' and .display. This assert checks only one child. Assert 3-5 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '30021000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-6"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-7"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-f8e1d2c9-6aff-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 4"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-4343301e-6aab-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '193570009'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '193570009'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '193570009'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '193570009'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '193570009'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2"/>
            <description value="Contains .clinicalStatus 'inactive' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '73425007' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').clinicalStatus.where($this = 'inactive' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '73425007' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').clinicalStatus.where($this = 'inactive' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '73425007' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2-1"/>
            <description value="Contains .clinicalStatus 'inactive'. This assert checks only one child. Assert 4-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').clinicalStatus = 'inactive''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').clinicalStatus = 'inactive'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '73425007' and .display. This assert checks only one child. Assert 4-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '73425007' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '73425007' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-3"/>
            <description value="Contains .code with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with and .coding with .system 'http://snomed.info/sct' and .code '193570009' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').code.where( and coding.where(system = 'http://snomed.info/sct' and code = '193570009' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').code.where( and coding.where(system = 'http://snomed.info/sct' and code = '193570009' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-3-1"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '193570009' and .display. This assert checks only one child. Assert 4-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').code.where(coding.where(system = 'http://snomed.info/sct' and code = '193570009' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').code.where(coding.where(system = 'http://snomed.info/sct' and code = '193570009' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-4"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-6"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-4343301e-6aab-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 5"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '193570009'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '193570009'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '193570009'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '193570009'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '193570009'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 5-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 5-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '193570009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '193570009' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '193570009' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-4"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24028007' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-6"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-7"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-2d8d2e49-6b35-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 6"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '239872002'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '239872002'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '239872002'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '239872002'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '239872002'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 6-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 6-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '239872002' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '239872002' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '239872002' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-4"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-6"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-7"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-1f053f02-6b42-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 7"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '49526009'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '49526009'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '49526009'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '49526009'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '49526009'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 7-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 7-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-3"/>
            <description value="Contains .verificationStatus 'confirmed' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '410605003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').verificationStatus.where($this = 'confirmed' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '410605003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').verificationStatus.where($this = 'confirmed' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '410605003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-3-1"/>
            <description value="Contains .verificationStatus 'confirmed'. This assert checks only one child. Assert 7-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').verificationStatus = 'confirmed''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').verificationStatus = 'confirmed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-3-2"/>
            <description value="Contains .verificationStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '410605003' and .display. This assert checks only one child. Assert 7-3 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').verificationStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '410605003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').verificationStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '410605003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-4"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '248536006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '248536006' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '248536006' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-5"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '49526009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '49526009' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '49526009' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-6"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24028007' and .display and .coding with .system 'http://snomed.info/sct' and .code '25577004' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display) and coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display) and coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-6-1"/>
            <description value="Contains .bodySite.extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24028007' and .display. This assert checks only one child. Assert 7-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-6-1"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '25577004' and .display. This assert checks only one child. Assert 7-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-7"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-8"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-9"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-74ff2e2f-6a96-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 8"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '2421000146101'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '2421000146101'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '2421000146101'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '2421000146101'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '2421000146101'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 8-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 8-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '2421000146101' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '2421000146101' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '2421000146101' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-4"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '84020006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '84020006' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '84020006' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-d896ce49-6b3a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 9"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-b383792f-6aba-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '68496003'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '68496003'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '68496003'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '68496003'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '68496003'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 9-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 9-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '282291009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '68496003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '68496003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '68496003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-5"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '362163004' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '362163004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '362163004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-6"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-7"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-8"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-b383792f-6aba-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 10"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '31641000146105'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '31641000146105'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '31641000146105'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '31641000146105'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '31641000146105'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 10-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 10-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '282291009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '282291009' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '31641000146105' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '31641000146105' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '31641000146105' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-5"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-6"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-7"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="10-8"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5cbb6f2a-6b05-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Problem - Check Condition 11"/>
      <description value="Check if the previous operation results in a FHIR Condition that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Condition with properties: contains .code.coding.code = '204609007'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '204609007'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '204609007'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Condition resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(code.where(coding.where(code = '204609007'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(code.where(coding.where(code = '204609007'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="11-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Problem').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="11-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="11-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 11-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="11-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '55561003' and .display. This assert checks only one child. Assert 11-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '55561003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="11-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '204609007' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '204609007' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '204609007' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="11-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Condition).where(id = '${BgZ-Problem-msz-5bcc6e86-6b26-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="07-serve-LivingSituation">
      <name value="Scenario 1.1 - LivingSituation"/>
      <description value="Serve Observation resource(s) for last known HCIM LivingSituation"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://snomed.info/sct|365508006"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-07-serve-LivingSituation"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LivingSituation - Check Observation"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LivingSituation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LivingSituation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LivingSituation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '365508006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '365508006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '365508006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.13.1' and .code 'FLATW' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.13.1' and code = 'FLATW' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.13.1' and code = 'FLATW' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LivingSituation-msz-5d6be30f-6ab1-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test id="08-serve-DrugUse">
      <name value="Scenario 1.1 - DrugUse"/>
      <description value="Serve Observation resource(s) for HCIM DrugUse"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://snomed.info/sct|228366006"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-08-serve-DrugUse"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - DrugUse - Check Observation 1"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .valueCodeableConcept.coding.code = '361055000'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(valueCodeableConcept.where(coding.where(code = '361055000'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(valueCodeableConcept.where(coding.where(code = '361055000'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(valueCodeableConcept.where(coding.where(code = '361055000'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(valueCodeableConcept.where(coding.where(code = '361055000'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-DrugUse'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-DrugUse').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-DrugUse').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '228366006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '228366006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '228366006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .effectivePeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').effective.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').effective.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '361055000' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '361055000' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '361055000' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '410942007' and .display, and .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '398705004' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display) and value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '398705004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display) and value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '398705004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '410942007' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '398705004' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '398705004' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '398705004' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '410675002' and .display, and .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '62' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display) and value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '62' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display) and value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '62' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '410675002' and .display. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '62' and .display. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '62' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '62' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '228390007' and .display, and .valueString with a value. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display) and value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display) and value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '228390007' and .display. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-2"/>
            <description value="Contains .component.valueString with a value. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-9af82c49-6b0e-11ec-0000-2-id}').component.where(value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - DrugUse - Check Observation 2"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .valueCodeableConcept.coding.code = '44870007'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(valueCodeableConcept.where(coding.where(code = '44870007'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(valueCodeableConcept.where(coding.where(code = '44870007'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(valueCodeableConcept.where(coding.where(code = '44870007'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(valueCodeableConcept.where(coding.where(code = '44870007'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-DrugUse'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-DrugUse').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-DrugUse').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '228366006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '228366006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '228366006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .effectivePeriod with .start and .end"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').effective.ofType(Period).where(start and end).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').effective.where($this is Period).where(start and end).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '44870007' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '44870007' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '44870007' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '410942007' and .display, and .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '288459003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display) and value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '288459003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display) and value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '288459003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '410942007' and .display. This assert checks only one child. Assert 2-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410942007' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '288459003' and .display. This assert checks only one child. Assert 2-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '288459003' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '288459003' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-9"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '410675002' and .display, and .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display) and value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display) and value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-9-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '410675002' and .display. This assert checks only one child. Assert 2-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '410675002' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-9-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display. This assert checks only one child. Assert 2-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '228390007' and .display, and .valueString with a value. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display) and value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display) and value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '228390007' and .display. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '228390007' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-2"/>
            <description value="Contains .component.valueString with a value. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(value.ofType(string).hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-DrugUse-msz-10348be2-6b4a-11ec-0000-2-id}').component.where(value.where($this is string).hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test id="09-serve-AlcoholUse">
      <name value="Scenario 1.1 - AlcoholUse"/>
      <description value="Serve Observation resource(s) for HCIM AlcoholUse"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://snomed.info/sct|228273003"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-09-serve-AlcoholUse"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AlcoholUse - Check Observation"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AlcoholUse'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AlcoholUse').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AlcoholUse').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '228273003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '228273003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '228273003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .effectivePeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').effective.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').effective.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '219006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '219006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '219006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '160573003' and .display, and .valueQuantity with .value '1' and .unit and .system 'http://unitsofmeasure.org' and .code '/d'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '160573003' and display) and value.ofType(Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code = '/d')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '160573003' and display) and value.where($this is Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code = '/d')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '160573003' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '160573003' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '160573003' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-2"/>
            <description value="Contains .component.valueQuantity with .value '1' and .unit and .system 'http://unitsofmeasure.org' and .code '/d'. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').component.where(value.ofType(Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code = '/d').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-AlcoholUse-msz-f68a62cf-6aeb-11ec-0000-2-id}').component.where(value.where($this is Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code = '/d').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="10-serve-TobaccoUse">
      <name value="Scenario 1.1 - TobaccoUse"/>
      <description value="Serve Observation resource(s) for HCIM TobaccoUse"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://snomed.info/sct|365980008"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-10-serve-TobaccoUse"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - TobaccoUse - Check Observation"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-TobaccoUse'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-TobaccoUse').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-TobaccoUse').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '365980008' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '365980008' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '365980008' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .effectivePeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').effective.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').effective.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '230059006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '230059006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '230059006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .comment with a value. This assert only checks existence of a value, because string comparisons can have many possible caveats"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').comment.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').comment.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '53661000146106' and .display, and .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '59978006' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '53661000146106' and display) and value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '59978006' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '53661000146106' and display) and value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '59978006' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '53661000146106' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '53661000146106' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '53661000146106' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '59978006' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '59978006' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '59978006' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '266918002' and .display, and .valueQuantity with .value '1' and .unit and .system 'http://unitsofmeasure.org' and .code matching regex '^\\{.+\\}/wk$'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '266918002' and display) and value.ofType(Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}/wk$'))).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '266918002' and display) and value.where($this is Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}/wk$'))).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '266918002' and .display. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '266918002' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '266918002' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-2"/>
            <description value="Contains .component.valueQuantity with .value '1' and .unit and .system 'http://unitsofmeasure.org' and .code matching regex '^\\{.+\\}/wk$'. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(value.ofType(Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}/wk$')).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(value.where($this is Quantity).where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}/wk$')).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '401201003' and .display, and .valueQuantity with .value '1' and .system 'http://unitsofmeasure.org' and .code matching regex '^\\{.+\\}$'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '401201003' and display) and value.ofType(Quantity).where(value = 1 and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}$'))).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '401201003' and display) and value.where($this is Quantity).where(value = 1 and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}$'))).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '401201003' and .display. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '401201003' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '401201003' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-2"/>
            <description value="Contains .component.valueQuantity with .value '1' and .system 'http://unitsofmeasure.org' and .code matching regex '^\\{.+\\}$'. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(value.ofType(Quantity).where(value = 1 and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}$')).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-TobaccoUse-msz-aac84e2f-6b26-11ec-0000-2-id}').component.where(value.where($this is Quantity).where(value = 1 and system = 'http://unitsofmeasure.org' and code.matches('^\\{.+\\}$')).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="11-serve-NutritionAdvice">
      <name value="Scenario 1.1 - NutritionAdvice"/>
      <description value="Serve NutritionOrder resource(s) for HCIM NutritionAdvice"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="NutritionOrder"/>
            <description value="Test Server to serve NutritionOrder resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-11-serve-NutritionAdvice"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the response Bundle contains 2 NutritionOrder resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(NutritionOrder)).count() = 2"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - NutritionAdvice - Check NutritionOrder 1"/>
      <description value="Check if the previous operation results in a FHIR NutritionOrder that contains the values that are expected following Nictiz' materials (fixture .id: zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 NutritionOrder with properties: contains .oralDiet.type.text = 'Groenten en fruit'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(oralDiet.where(type.where(text = 'Groenten en fruit'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(oralDiet.where(type.where(text = 'Groenten en fruit'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="NutritionOrder resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(oralDiet.where(type.where(text = 'Groenten en fruit'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(oralDiet.where(type.where(text = 'Groenten en fruit'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice').exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice-Explanation' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice-Explanation').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice-Explanation').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .dateTime with .extension with url 'http://hl7.org/fhir/StructureDefinition/data-absent-reason' with .valueCode 'unknown'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').dateTime.where(extension('http://hl7.org/fhir/StructureDefinition/data-absent-reason').value.ofType(code) = 'unknown').exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').dateTime.where(extension('http://hl7.org/fhir/StructureDefinition/data-absent-reason').value.where($this is code) = 'unknown').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .oralDiet with .type with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').oralDiet.type.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-1e4994f6-6ab5-11ec-0000-2-id}').oralDiet.type.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - NutritionAdvice - Check NutritionOrder 2"/>
      <description value="Check if the previous operation results in a FHIR NutritionOrder that contains the values that are expected following Nictiz' materials (fixture .id: zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 NutritionOrder with properties: contains .oralDiet.type.text = 'Eiwitrijk voedsel'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(oralDiet.where(type.where(text = 'Eiwitrijk voedsel'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(oralDiet.where(type.where(text = 'Eiwitrijk voedsel'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="NutritionOrder resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(oralDiet.where(type.where(text = 'Eiwitrijk voedsel'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(oralDiet.where(type.where(text = 'Eiwitrijk voedsel'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice').exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice-Explanation' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice-Explanation').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-NutritionAdvice-Explanation').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .dateTime with .extension with url 'http://hl7.org/fhir/StructureDefinition/data-absent-reason' with .valueCode 'unknown'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').dateTime.where(extension('http://hl7.org/fhir/StructureDefinition/data-absent-reason').value.ofType(code) = 'unknown').exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').dateTime.where(extension('http://hl7.org/fhir/StructureDefinition/data-absent-reason').value.where($this is code) = 'unknown').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .oralDiet with .type with .text with a value, and .texture with .modifier with .text with a value and .foodType with .text with a value, and .fluidConsistencyType with .text with a value. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.where(type.where(text.hasValue()) and texture.where(modifier.text.hasValue() and foodType.text.hasValue()) and fluidConsistencyType.where(text.hasValue())).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.where(type.where(text.hasValue()) and texture.where(modifier.text.hasValue() and foodType.text.hasValue()) and fluidConsistencyType.where(text.hasValue())).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6-1"/>
            <description value="Contains .oralDiet.type with .text with a value. This assert checks only one child. Assert 2-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.type.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.type.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6-2"/>
            <description value="Contains .oralDiet.texture with .modifier with .text with a value, and .foodType with .text with a value. This assert checks only one child. Assert 2-6 checks if all children are present in the same parent. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.texture.where(modifier.text.hasValue() and foodType.text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.texture.where(modifier.text.hasValue() and foodType.text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6-2-1"/>
            <description value="Contains .oralDiet.texture.modifier with .text with a value. This assert checks only one child. Assert 2-6-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.texture.where(modifier.text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.texture.where(modifier.text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6-2-2"/>
            <description value="Contains .oralDiet.texture.foodType with .text with a value. This assert checks only one child. Assert 2-6-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.texture.where(foodType.text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.texture.where(foodType.text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6-3"/>
            <description value="Contains .oralDiet.fluidConsistencyType with .text with a value. This assert checks only one child. Assert 2-6 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.fluidConsistencyType.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is NutritionOrder).where(id = '${zib-NutritionAdvice-msz-6b3df80f-6b39-11ec-0000-2-id}').oralDiet.fluidConsistencyType.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="12-serve-Alert">
      <name value="Scenario 1.1 - Alert"/>
      <description value="Serve Flag resource(s) for HCIM Alert"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Flag"/>
            <description value="Test Server to serve Flag resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-12-serve-Alert"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Alert - Check Flag 1"/>
      <description value="Check if the previous operation results in a FHIR Flag that contains the values that are expected following Nictiz' materials (fixture .id: zib-Alert-msz-da3abd4f-6b27-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Flag with properties: contains .code.coding.code = 'OTH'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(code.where(coding.where(code = 'OTH'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(code.where(coding.where(code = 'OTH'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Flag resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(code.where(coding.where(code = 'OTH'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(code.where(coding.where(code = 'OTH'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Alert'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Alert').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Alert').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://loinc.org' and .code '74018-3' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').category.coding.where(system = 'http://loinc.org' and code = '74018-3' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').category.coding.where(system = 'http://loinc.org' and code = '74018-3' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').code.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').code.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .period with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').period.start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-da3abd4f-6b27-11ec-0000-2-id}').period.start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Alert - Check Flag 2"/>
      <description value="Check if the previous operation results in a FHIR Flag that contains the values that are expected following Nictiz' materials (fixture .id: zib-Alert-msz-2a5e074f-6af2-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Flag with properties: contains .code.coding.code = '432415000'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(code.where(coding.where(code = '432415000'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(code.where(coding.where(code = '432415000'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Flag resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(code.where(coding.where(code = '432415000'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(code.where(coding.where(code = '432415000'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Alert'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Alert').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Alert').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .category with .coding with .system 'http://loinc.org' and .code '74018-3' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').category.coding.where(system = 'http://loinc.org' and code = '74018-3' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').category.coding.where(system = 'http://loinc.org' and code = '74018-3' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '432415000' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '432415000' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '432415000' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Flag).where(id = '${zib-Alert-msz-2a5e074f-6af2-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="13-serve-AllergyIntolerance">
      <name value="Scenario 1.1 - AllergyIntolerance"/>
      <description value="Serve AllergyIntolerance resource(s) for HCIM AllergyIntolerance"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="AllergyIntolerance"/>
            <description value="Test Server to serve AllergyIntolerance resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-13-serve-AllergyIntolerance"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AllergyIntolerance - Check AllergyIntolerance 1"/>
      <description value="Check if the previous operation results in a FHIR AllergyIntolerance that contains the values that are expected following Nictiz' materials (fixture .id: zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 AllergyIntolerance with properties: contains .code.coding.code = '764146007'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '764146007'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '764146007'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="AllergyIntolerance resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '764146007'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '764146007'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance').exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/ActStatus' and .code 'active' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/ActStatus' and .code 'active' and .display. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .verificationStatus 'confirmed'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').verificationStatus = 'confirmed''-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').verificationStatus = 'confirmed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '764146007' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '764146007' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '764146007' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-7dc8d13d-6b3a-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AllergyIntolerance - Check AllergyIntolerance 2"/>
      <description value="Check if the previous operation results in a FHIR AllergyIntolerance that contains the values that are expected following Nictiz' materials (fixture .id: zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 AllergyIntolerance with properties: contains .code.coding.code = '13577000'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '13577000'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '13577000'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="AllergyIntolerance resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '13577000'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '13577000'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance').exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .clinicalStatus 'active' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/ActStatus' and .code 'active' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').clinicalStatus.where($this = 'active' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2-1"/>
            <description value="Contains .clinicalStatus 'active'. This assert checks only one child. Assert 2-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').clinicalStatus = 'active''-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').clinicalStatus = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/ActStatus' and .code 'active' and .display. This assert checks only one child. Assert 2-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'active' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .verificationStatus 'confirmed'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').verificationStatus = 'confirmed''-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').verificationStatus = 'confirmed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '13577000' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '13577000' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '13577000' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-9211edf5-6b3a-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AllergyIntolerance - Check AllergyIntolerance 3"/>
      <description value="Check if the previous operation results in a FHIR AllergyIntolerance that contains the values that are expected following Nictiz' materials (fixture .id: zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 AllergyIntolerance with properties: contains .code.coding.code = '111088007'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '111088007'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '111088007'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="AllergyIntolerance resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(code.where(coding.where(code = '111088007'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(code.where(coding.where(code = '111088007'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance').exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AllergyIntolerance').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2"/>
            <description value="Contains .clinicalStatus 'resolved' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/ActStatus' and .code 'completed' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').clinicalStatus.where($this = 'resolved' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'completed' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').clinicalStatus.where($this = 'resolved' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'completed' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2-1"/>
            <description value="Contains .clinicalStatus 'resolved'. This assert checks only one child. Assert 3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').clinicalStatus = 'resolved''-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').clinicalStatus = 'resolved'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2-2"/>
            <description value="Contains .clinicalStatus.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'http://hl7.org/fhir/v3/ActStatus' and .code 'completed' and .display. This assert checks only one child. Assert 3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'completed' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').clinicalStatus.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'http://hl7.org/fhir/v3/ActStatus' and code = 'completed' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-3"/>
            <description value="Contains .verificationStatus 'confirmed'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').verificationStatus = 'confirmed''-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').verificationStatus = 'confirmed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '111088007' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '111088007' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '111088007' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-6"/>
            <description value="Contains .onsetDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').onset.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is AllergyIntolerance).where(id = '${zib-AllergyIntolerance-msz-e9d409ee-6b73-11ec-0000-2-id}').onset.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="14-serve-MedicationUse">
      <name value="Scenario 1.1 - MedicationUse"/>
      <description value="Serve MedicationStatement resource(s) including the medication for HCIM MedicationUse"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="MedicationStatement"/>
            <description value="Test Server to serve MedicationStatement resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3|6&amp;_include=MedicationStatement:medication"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-14-serve-MedicationUse"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicationUse - Check MedicationStatement 1"/>
      <description value="Check if the previous operation results in a FHIR MedicationStatement that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 MedicationStatement with properties: contains .medicationReference with reference to medication with code.coding.code = '35475'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="MedicationStatement resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Author' with .valueReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Author').value.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Author').value.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .category with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3' and .code '6' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').category.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3' and code = '6' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').category.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3' and code = '6' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .medicationReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').medication.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').medication.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .dateAsserted"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').dateAsserted.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').dateAsserted.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .taken 'y'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').taken = 'y''-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').taken = 'y'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11"/>
            <description value="Contains .dosage with .route with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').dosage.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-9391eecf-6b38-11ec-0000-2-id}').dosage.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicationUse - Check MedicationStatement 2"/>
      <description value="Check if the previous operation results in a FHIR MedicationStatement that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 MedicationStatement with properties: contains .medicationReference with reference to medication with code.coding.code = '67903'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="MedicationStatement resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-AsAgreedIndicator' with .valueBoolean 'true'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-AsAgreedIndicator').value.ofType(boolean) = true'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-AsAgreedIndicator').value.where($this is boolean) = true"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Author' with .valueReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Author').value.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Author').value.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .category with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3' and .code '6' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').category.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3' and code = '6' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').category.where(coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3' and code = '6' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .medicationReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').medication.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').medication.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .dateAsserted"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').dateAsserted.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').dateAsserted.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-9"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10"/>
            <description value="Contains .taken 'y'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').taken = 'y''-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').taken = 'y'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-11"/>
            <description value="Contains .dosage with .route with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').dosage.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationStatement).where(id = '${zib-MedicationUse-msz-b7239dd9-6ad4-11ec-0000-2-id}').dosage.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicationUse - Check Medication 1"/>
      <description value="Check if the previous operation results in a FHIR Medication that contains the values that are expected following Nictiz' materials (fixture .id: zib-Product-msz-1aa30579-6b58-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Medication with properties: contains .code.coding.code = '67903'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '67903'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '67903'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Medication resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '67903'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '67903'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Product'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-1aa30579-6b58-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-1aa30579-6b58-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .code with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.10' and .code '67903' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-1aa30579-6b58-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '67903' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-1aa30579-6b58-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '67903' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicationUse - Check Medication 2"/>
      <description value="Check if the previous operation results in a FHIR Medication that contains the values that are expected following Nictiz' materials (fixture .id: zib-Product-msz-33e35a59-6b47-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Medication with properties: contains .code.coding.code = '35475'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '35475'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '35475'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Medication resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '35475'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '35475'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Product'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-33e35a59-6b47-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-33e35a59-6b47-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .code with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.10' and .code '35475' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-33e35a59-6b47-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '35475' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-33e35a59-6b47-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.10' and code = '35475' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="15-serve-MedicationAgreement">
      <name value="Scenario 1.1 - MedicationAgreement"/>
      <description value="Serve MedicationRequest resource(s) including the medication for HCIM MedicationAgreement"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="MedicationRequest"/>
            <description value="Test Server to serve MedicationRequest resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=http://snomed.info/sct|16076005&amp;_include=MedicationRequest:medication"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-15-serve-MedicationAgreement"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicationAgreement - Check MedicationRequest 1"/>
      <description value="Check if the previous operation results in a FHIR MedicationRequest that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 MedicationRequest with properties: contains .medicationReference with reference to medication with code.coding.code = '67903'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="MedicationRequest resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '67903'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationAgreement'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationAgreement').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationAgreement').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration' with .valueDuration with .value '15' and .unit with a value and .system and .code 'd'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.ofType(Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.where($this is Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .intent 'order'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').intent = 'order''-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').intent = 'order'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '16076005' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '16076005' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '16076005' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .medicationReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').medication.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').medication.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .authoredOn"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').authoredOn.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').authoredOn.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .requester with .agent with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference' with .valueReference with either .reference or .identifier and .display, and with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').requester.agent.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.ofType(Reference).where((reference or identifier) and display) and (reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').requester.agent.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.where($this is Reference).where((reference or identifier) and display) and (reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .dosageInstruction with .sequence '1', and .additionalInstruction with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value, and .timing with .repeat with .frequency '4' and .period '1' and .periodUnit 'd', and .route with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display, and .doseQuantity with .value '2' and .unit and .system 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and .code 'ST'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(sequence = 1 and additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()) and timing.repeat.where(frequency = 4 and period = 1 and periodUnit = 'd') and route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display) and dose.ofType(Quantity).where(value = 2 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(sequence = 1 and additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()) and timing.repeat.where(frequency = 4 and period = 1 and periodUnit = 'd') and route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display) and dose.where($this is Quantity).where(value = 2 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-1"/>
            <description value="Contains .dosageInstruction.sequence '1'. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(sequence = 1).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(sequence = 1).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-2"/>
            <description value="Contains .dosageInstruction.additionalInstruction with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-3"/>
            <description value="Contains .dosageInstruction.timing with .repeat with .frequency '4' and .period '1' and .periodUnit 'd'. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(timing.repeat.where(frequency = 4 and period = 1 and periodUnit = 'd').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(timing.repeat.where(frequency = 4 and period = 1 and periodUnit = 'd').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-4"/>
            <description value="Contains .dosageInstruction.route with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-5"/>
            <description value="Contains .dosageInstruction.doseQuantity with .value '2' and .unit and .system 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and .code 'ST'. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(dose.ofType(Quantity).where(value = 2 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-c359e452-6b21-11ec-0000-2-id}').dosageInstruction.where(dose.where($this is Quantity).where(value = 2 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicationAgreement - Check MedicationRequest 2"/>
      <description value="Check if the previous operation results in a FHIR MedicationRequest that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 MedicationRequest with properties: contains .medicationReference with reference to medication with code.coding.code = '35475'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="MedicationRequest resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(medicationReference.resolve().code.where(coding.where(code = '35475'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationAgreement'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationAgreement').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationAgreement').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration' with .valueDuration with .value '15' and .unit with a value and .system and .code 'd'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.ofType(Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.where($this is Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription' with .valueString with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.ofType(string).hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-Medication-InstructionsForUseDescription').value.where($this is string).hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .intent 'order'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').intent = 'order''-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').intent = 'order'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '16076005' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '16076005' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '16076005' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .medicationReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').medication.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').medication.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .authoredOn"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').authoredOn.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').authoredOn.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-9"/>
            <description value="Contains .requester with .agent with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference' with .valueReference with either .reference or .identifier and .display, and with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').requester.agent.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.ofType(Reference).where((reference or identifier) and display) and (reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').requester.agent.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.where($this is Reference).where((reference or identifier) and display) and (reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10"/>
            <description value="Contains .dosageInstruction with .sequence '1', and .additionalInstruction with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value, and .additionalInstruction with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value, and .timing with .repeat with .frequency '3' and .period '1' and .periodUnit 'd', and .route with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display, and .doseQuantity with .value '1' and .unit and .system 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and .code 'ST'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(sequence = 1 and additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()) and additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()) and timing.repeat.where(frequency = 3 and period = 1 and periodUnit = 'd') and route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display) and dose.ofType(Quantity).where(value = 1 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(sequence = 1 and additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()) and additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()) and timing.repeat.where(frequency = 3 and period = 1 and periodUnit = 'd') and route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display) and dose.where($this is Quantity).where(value = 1 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-1"/>
            <description value="Contains .dosageInstruction.sequence '1'. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(sequence = 1).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(sequence = 1).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-2"/>
            <description value="Contains .dosageInstruction.additionalInstruction with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-3"/>
            <description value="Contains .dosageInstruction.additionalInstruction with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(additionalInstruction.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-4"/>
            <description value="Contains .dosageInstruction.timing with .repeat with .frequency '3' and .period '1' and .periodUnit 'd'. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(timing.repeat.where(frequency = 3 and period = 1 and periodUnit = 'd').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(timing.repeat.where(frequency = 3 and period = 1 and periodUnit = 'd').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-5"/>
            <description value="Contains .dosageInstruction.route with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.9' and .code '9' and .display. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(route.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.9' and code = '9' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-10-6"/>
            <description value="Contains .dosageInstruction.doseQuantity with .value '1' and .unit and .system 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and .code 'ST'. This assert checks only one child. Assert 2-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(dose.ofType(Quantity).where(value = 1 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationRequest).where(id = '${zib-MedicationAgreement-msz-2b9f02d2-6b17-11ec-0000-2-id}').dosageInstruction.where(dose.where($this is Quantity).where(value = 1 and unit and system = 'urn:oid:2.16.840.1.113883.2.4.4.1.900.2' and code = 'ST').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="16-serve-AdministrationAgreement">
      <name value="Scenario 1.1 - AdministrationAgreement"/>
      <description value="Serve MedicationDispense resource(s) including the medication for HCIM AdministrationAgreement"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="MedicationDispense"/>
            <description value="Test Server to serve MedicationDispense resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=http://snomed.info/sct|422037009&amp;_include=MedicationDispense:medication"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-16-serve-AdministrationAgreement"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AdministrationAgreement - Check MedicationDispense 1"/>
      <description value="Check if the previous operation results in a FHIR MedicationDispense that contains the values that are expected following Nictiz' materials (fixture .id: zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 MedicationDispense with properties: contains .medicationReference with reference to medication with code.coding.code = '2456451'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '2456451'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '2456451'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="MedicationDispense resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '2456451'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '2456451'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AdministrationAgreement'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AdministrationAgreement').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AdministrationAgreement').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration' with .valueDuration with .value '15' and .unit with a value and .system and .code 'd'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.ofType(Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.where($this is Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '422037009' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '422037009' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '422037009' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .medicationReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').medication.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').medication.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-d3a233c5-6b20-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AdministrationAgreement - Check MedicationDispense 2"/>
      <description value="Check if the previous operation results in a FHIR MedicationDispense that contains the values that are expected following Nictiz' materials (fixture .id: zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 MedicationDispense with properties: contains .medicationReference with reference to medication with code.coding.code = '1112740'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '1112740'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '1112740'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="MedicationDispense resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '1112740'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(medicationReference.resolve().code.where(coding.where(code = '1112740'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-AdministrationAgreement'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AdministrationAgreement').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-AdministrationAgreement').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration' with .valueDuration with .value '15' and .unit with a value and .system and .code 'd'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.ofType(Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicationUse-Duration').value.where($this is Duration).where(value = 15 and unit.hasValue() and system and code = 'd').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '422037009' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '422037009' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '422037009' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .medicationReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').medication.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').medication.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is MedicationDispense).where(id = '${zib-AdministrationAgreement-msz-c84431bd-6af3-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AdministrationAgreement - Check Medication 1"/>
      <description value="Check if the previous operation results in a FHIR Medication that contains the values that are expected following Nictiz' materials (fixture .id: zib-Product-msz-ed64af2f-6b27-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Medication with properties: contains .code.coding.code = '2456451'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '2456451'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '2456451'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Medication resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '2456451'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '2456451'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Product'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-ed64af2f-6b27-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-ed64af2f-6b27-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .code with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.7' and .code '2456451' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-ed64af2f-6b27-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.7' and code = '2456451' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-ed64af2f-6b27-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.7' and code = '2456451' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - AdministrationAgreement - Check Medication 2"/>
      <description value="Check if the previous operation results in a FHIR Medication that contains the values that are expected following Nictiz' materials (fixture .id: zib-Product-msz-ad7d7eef-6b2d-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Medication with properties: contains .code.coding.code = '1112740'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '1112740'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '1112740'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Medication resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(code.where(coding.where(code = '1112740'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(code.where(coding.where(code = '1112740'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Product'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-ad7d7eef-6b2d-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-ad7d7eef-6b2d-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Product').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .code with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.4.7' and .code '1112740' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Medication).where(id = '${zib-Product-msz-ad7d7eef-6b2d-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.7' and code = '1112740' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Medication).where(id = '${zib-Product-msz-ad7d7eef-6b2d-11ec-0000-2-id}').code.coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.4.7' and code = '1112740' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="17-serve-MedicalDevice">
      <name value="Scenario 1.1 - MedicalDevice"/>
      <description value="Serve DeviceUseStatement resource(s) including the device for HCIM MedicalDevice"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="DeviceUseStatement"/>
            <description value="Test Server to serve DeviceUseStatement resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;_include=DeviceUseStatement:device"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-17-serve-MedicalDevice"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicalDevice - Check DeviceUseStatement 1"/>
      <description value="Check if the previous operation results in a FHIR DeviceUseStatement that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 DeviceUseStatement with properties: contains .device with reference to Device with type.coding.code = '466193006'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '466193006'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '466193006'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="DeviceUseStatement resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '466193006'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '466193006'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice').exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice-Organization' with .valueReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice-Organization').value.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice-Organization').value.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .whenUsed with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').whenUsed.start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').whenUsed.start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .device with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').device.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').device.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-17d02da2-6b4a-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicalDevice - Check DeviceUseStatement 2"/>
      <description value="Check if the previous operation results in a FHIR DeviceUseStatement that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 DeviceUseStatement with properties: contains .device with reference to Device with type.coding.code = '360283003'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '360283003'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '360283003'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="DeviceUseStatement resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '360283003'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(device.resolve().type.where(coding.where(code = '360283003'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice').exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .extension with url 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice-Organization' with .valueReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice-Organization').value.ofType(Reference).where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').extension('http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDevice-Organization').value.where($this is Reference).where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .whenUsed with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').whenUsed.start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').whenUsed.start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .device with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').device.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').device.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24028007' and .display and .coding with .system 'http://snomed.info/sct' and .code '25577004' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display) and coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display) and coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7-1"/>
            <description value="Contains .bodySite.extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24028007' and .display. This assert checks only one child. Assert 2-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').bodySite.extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').bodySite.extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7-1"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '25577004' and .display. This assert checks only one child. Assert 2-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '25577004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is DeviceUseStatement).where(id = '${zib-MedicalDevice-msz-991e9342-6a98-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicalDevice - Check Device 1"/>
      <description value="Check if the previous operation results in a FHIR Device that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Device with properties: contains .type.coding.code = '466193006'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(type.where(coding.where(code = '466193006'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(type.where(coding.where(code = '466193006'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Device resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(type.where(coding.where(code = '466193006'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(type.where(coding.where(code = '466193006'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDeviceProduct'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDeviceProduct').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDeviceProduct').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .type with .coding with .system 'http://snomed.info/sct' and .code '466193006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').type.coding.where(system = 'http://snomed.info/sct' and code = '466193006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').type.coding.where(system = 'http://snomed.info/sct' and code = '466193006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-17d02da2-6b4a-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - MedicalDevice - Check Device 2"/>
      <description value="Check if the previous operation results in a FHIR Device that contains the values that are expected following Nictiz' materials (fixture .id: zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Device with properties: contains .type.coding.code = '360283003'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(type.where(coding.where(code = '360283003'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(type.where(coding.where(code = '360283003'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Device resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(type.where(coding.where(code = '360283003'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(type.where(coding.where(code = '360283003'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDeviceProduct'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDeviceProduct').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-MedicalDeviceProduct').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .identifier with .system and .value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').identifier.where(system and value).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').identifier.where(system and value).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .udi with .carrierHRF with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').udi.carrierHRF.hasValue()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').udi.carrierHRF.hasValue()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .type with .coding with .system 'http://snomed.info/sct' and .code '360283003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').type.coding.where(system = 'http://snomed.info/sct' and code = '360283003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').type.coding.where(system = 'http://snomed.info/sct' and code = '360283003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Device).where(id = '${zib-MedicalDeviceProduct-msz-991e9342-6a98-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="18-serve-Vaccination">
      <name value="Scenario 1.1 - Vaccination"/>
      <description value="Serve Immunization resource(s) for HCIM Vaccination"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Immunization"/>
            <description value="Test Server to serve Immunization resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;status=completed"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-18-serve-Vaccination"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Vaccination - Check Immunization 1"/>
      <description value="Check if the previous operation results in a FHIR Immunization that contains the values that are expected following Nictiz' materials (fixture .id: zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Immunization with properties: contains .vaccineCode.coding.code = 'J07BC20'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(vaccineCode.where(coding.where(code = 'J07BC20'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(vaccineCode.where(coding.where(code = 'J07BC20'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Immunization resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(vaccineCode.where(coding.where(code = 'J07BC20'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(vaccineCode.where(coding.where(code = 'J07BC20'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Vaccination'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Vaccination').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Vaccination').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'completed'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').status = 'completed''-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').status = 'completed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .notGiven 'false'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').notGiven = false'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').notGiven = false"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .vaccineCode with .coding with .system 'http://www.whocc.no/atc' and .code 'J07BC20' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').vaccineCode.coding.where(system = 'http://www.whocc.no/atc' and code = 'J07BC20' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').vaccineCode.coding.where(system = 'http://www.whocc.no/atc' and code = 'J07BC20' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .date"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').date.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').date.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .primarySource 'false'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').primarySource = false'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').primarySource = false"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .doseQuantity with .value '1' and .unit and .system 'http://unitsofmeasure.org' and .code 'mL'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').doseQuantity.where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code = 'mL').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').doseQuantity.where(value = 1 and unit and system = 'http://unitsofmeasure.org' and code = 'mL').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-50bd2939-6ae8-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Vaccination - Check Immunization 2"/>
      <description value="Check if the previous operation results in a FHIR Immunization that contains the values that are expected following Nictiz' materials (fixture .id: zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Immunization with properties: contains .vaccineCode.coding.code = 'J07AM01'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(vaccineCode.where(coding.where(code = 'J07AM01'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(vaccineCode.where(coding.where(code = 'J07AM01'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Immunization resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(vaccineCode.where(coding.where(code = 'J07AM01'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(vaccineCode.where(coding.where(code = 'J07AM01'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Vaccination'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Vaccination').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Vaccination').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'completed'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').status = 'completed''-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').status = 'completed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .notGiven 'false'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').notGiven = false'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').notGiven = false"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .vaccineCode with .coding with .system 'http://www.whocc.no/atc' and .code 'J07AM01' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').vaccineCode.coding.where(system = 'http://www.whocc.no/atc' and code = 'J07AM01' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').vaccineCode.coding.where(system = 'http://www.whocc.no/atc' and code = 'J07AM01' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .patient with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').patient.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .date"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').date.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').date.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .primarySource 'false'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').primarySource = false'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').primarySource = false"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .note with .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').note.where(text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Immunization).where(id = '${zib-Vaccination-msz-b7d8c99e-6b13-11ec-0000-2-id}').note.where(text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="19-serve-BloodPressure">
      <name value="Scenario 1.1 - BloodPressure"/>
      <description value="Serve Observation resource(s) for HCIM BloodPressure"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="/$lastn?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://loinc.org|85354-9"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-19-serve-BloodPressure"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - BloodPressure - Check Observation"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-BloodPressure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-BloodPressure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-BloodPressure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://hl7.org/fhir/observation-category' and .code 'vital-signs' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').category.where(coding.where(system = 'http://hl7.org/fhir/observation-category' and code = 'vital-signs' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').category.where(coding.where(system = 'http://hl7.org/fhir/observation-category' and code = 'vital-signs' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '85354-9' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '85354-9' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '85354-9' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .effectiveDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').effective.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').effective.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '368209003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').bodySite.coding.where(system = 'http://snomed.info/sct' and code = '368209003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').bodySite.coding.where(system = 'http://snomed.info/sct' and code = '368209003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .method with .coding with .system 'http://snomed.info/sct' and .code '22762002' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').method.coding.where(system = 'http://snomed.info/sct' and code = '22762002' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').method.coding.where(system = 'http://snomed.info/sct' and code = '22762002' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9"/>
            <description value="Contains .component with .code with .coding with .system 'http://loinc.org' and .code '8480-6' and .display, and .valueQuantity with .value '130' and .unit and .system 'http://unitsofmeasure.org' and .code 'mm[Hg]'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8480-6' and display) and value.ofType(Quantity).where(value = 130 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8480-6' and display) and value.where($this is Quantity).where(value = 130 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-1"/>
            <description value="Contains .component.code with .coding with .system 'http://loinc.org' and .code '8480-6' and .display. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8480-6' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8480-6' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-9-2"/>
            <description value="Contains .component.valueQuantity with .value '130' and .unit and .system 'http://unitsofmeasure.org' and .code 'mm[Hg]'. This assert checks only one child. Assert 1-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(Quantity).where(value = 130 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is Quantity).where(value = 130 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10"/>
            <description value="Contains .component with .code with .coding with .system 'http://loinc.org' and .code '8462-4' and .display, and .valueQuantity with .value '79' and .unit and .system 'http://unitsofmeasure.org' and .code 'mm[Hg]'. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8462-4' and display) and value.ofType(Quantity).where(value = 79 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]')).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8462-4' and display) and value.where($this is Quantity).where(value = 79 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]')).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-1"/>
            <description value="Contains .component.code with .coding with .system 'http://loinc.org' and .code '8462-4' and .display. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8462-4' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8462-4' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-10-2"/>
            <description value="Contains .component.valueQuantity with .value '79' and .unit and .system 'http://unitsofmeasure.org' and .code 'mm[Hg]'. This assert checks only one child. Assert 1-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(Quantity).where(value = 79 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]').exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is Quantity).where(value = 79 and unit and system = 'http://unitsofmeasure.org' and code = 'mm[Hg]').exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '85549003' and .display, and .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '255271000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '85549003' and display) and value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255271000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '85549003' and display) and value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255271000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '85549003' and .display. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '85549003' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '85549003' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-11-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '255271000' and .display. This assert checks only one child. Assert 1-11 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255271000' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '255271000' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-12"/>
            <description value="Contains .component with .code with .coding with .system 'http://loinc.org' and .code '8358-4' and .display, and .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and .code 'STD' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8358-4' and display) and value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8358-4' and display) and value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-12-1"/>
            <description value="Contains .component.code with .coding with .system 'http://loinc.org' and .code '8358-4' and .display. This assert checks only one child. Assert 1-12 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8358-4' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8358-4' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-12-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and .code 'STD' and .display. This assert checks only one child. Assert 1-12 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-13"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '70665002' and .display, and .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and .code 'STD' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '70665002' and display) and value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '70665002' and display) and value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-13-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '70665002' and .display. This assert checks only one child. Assert 1-13 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '70665002' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '70665002' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-13-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and .code 'STD' and .display. This assert checks only one child. Assert 1-13 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.15.1' and code = 'STD' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-14"/>
            <description value="Contains .component with .code with .coding with .system 'http://snomed.info/sct' and .code '424724000' and .display, and .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '102538003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '424724000' and display) and value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '424724000' and display) and value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-14-1"/>
            <description value="Contains .component.code with .coding with .system 'http://snomed.info/sct' and .code '424724000' and .display. This assert checks only one child. Assert 1-14 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '424724000' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://snomed.info/sct' and code = '424724000' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-14-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '102538003' and .display. This assert checks only one child. Assert 1-14 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-15"/>
            <description value="Contains .component with .code with .coding with .system 'http://loinc.org' and .code '8361-8' and .display, and .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '102538003' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8361-8' and display) and value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8361-8' and display) and value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-15-1"/>
            <description value="Contains .component.code with .coding with .system 'http://loinc.org' and .code '8361-8' and .display. This assert checks only one child. Assert 1-15 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8361-8' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8361-8' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-15-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '102538003' and .display. This assert checks only one child. Assert 1-15 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BloodPressure-msz-a05bf7e1-6b55-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '102538003' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="20-serve-BodyWeight">
      <name value="Scenario 1.1 - BodyWeight"/>
      <description value="Serve Observation resource(s) for last known HCIM BodyWeight"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://loinc.org|29463-7"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-20-serve-BodyWeight"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the response Bundle contains 1 Observation resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(Observation)).count() = 1"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - BodyWeight - Check Observation"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-BodyWeight'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-BodyWeight').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-BodyWeight').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://hl7.org/fhir/observation-category' and .code 'vital-signs' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').category.where(coding.where(system = 'http://hl7.org/fhir/observation-category' and code = 'vital-signs' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').category.where(coding.where(system = 'http://hl7.org/fhir/observation-category' and code = 'vital-signs' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '29463-7' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '29463-7' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '29463-7' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .effectiveDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').effective.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').effective.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .valueQuantity with .value '86' and .unit and .system 'http://unitsofmeasure.org' and .code 'kg'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').value.ofType(Quantity).where(value = 86 and unit and system = 'http://unitsofmeasure.org' and code = 'kg').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').value.where($this is Quantity).where(value = 86 and unit and system = 'http://unitsofmeasure.org' and code = 'kg').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .component with .code with .coding with .system 'http://loinc.org' and .code '8352-7' and .display, and .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.8.1' and .code 'FULL' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8352-7' and display) and value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.8.1' and code = 'FULL' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8352-7' and display) and value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.8.1' and code = 'FULL' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-1"/>
            <description value="Contains .component.code with .coding with .system 'http://loinc.org' and .code '8352-7' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8352-7' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').component.where(code.coding.where(system = 'http://loinc.org' and code = '8352-7' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8-2"/>
            <description value="Contains .component.valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.8.1' and .code 'FULL' and .display. This assert checks only one child. Assert 1-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').component.where(value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.8.1' and code = 'FULL' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyWeight-msz-5b482919-6b6d-11ec-0000-2-id}').component.where(value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.8.1' and code = 'FULL' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="21-serve-BodyHeight">
      <name value="Scenario 1.1 - BodyHeight"/>
      <description value="Serve Observation resource(s) for last known HCIM BodyHeight"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://loinc.org|8302-2,http://loinc.org|8306-3,http://loinc.org|8308-9"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-21-serve-BodyHeight"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the response Bundle contains 1 Observation resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(Observation)).count() = 1"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - BodyHeight - Check Observation"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-BodyHeight'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-BodyHeight').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-BodyHeight').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://hl7.org/fhir/observation-category' and .code 'vital-signs' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').category.where(coding.where(system = 'http://hl7.org/fhir/observation-category' and code = 'vital-signs' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').category.where(coding.where(system = 'http://hl7.org/fhir/observation-category' and code = 'vital-signs' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '8302-2' and .display and .coding with .system 'http://loinc.org' and .code '8308-9' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').code.where(coding.where(system = 'http://loinc.org' and code = '8302-2' and display) and coding.where(system = 'http://loinc.org' and code = '8308-9' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').code.where(coding.where(system = 'http://loinc.org' and code = '8302-2' and display) and coding.where(system = 'http://loinc.org' and code = '8308-9' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .effectiveDateTime"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').effective.ofType(dateTime).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').effective.where($this is dateTime).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .valueQuantity with .value '183' and .unit and .system 'http://unitsofmeasure.org' and .code 'cm'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').value.ofType(Quantity).where(value = 183 and unit and system = 'http://unitsofmeasure.org' and code = 'cm').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-BodyHeight-msz-3c4e53b1-6b28-11ec-0000-2-id}').value.where($this is Quantity).where(value = 183 and unit and system = 'http://unitsofmeasure.org' and code = 'cm').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="22-serve-LaboratoryTestResult">
      <name value="Scenario 1.1 - LaboratoryTestResult"/>
      <description value="Serve Observation resource(s) for HCIM LaboratoryTestResult"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Observation"/>
            <description value="Test Server to serve Observation resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;category=http://snomed.info/sct|49581000146104&amp;_include=Observation:related-target"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-22-serve-LaboratoryTestResult"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 1"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '59260-0' and .valueQuantity.value = '10.9'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59260-0')) and value.ofType(Quantity).value = 10.9).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59260-0')) and value.where($this is Quantity).value = 10.9).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59260-0')) and value.ofType(Quantity).value = 10.9).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59260-0')) and value.where($this is Quantity).value = 10.9).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 1-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '59260-0' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '59260-0' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '59260-0' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .valueQuantity with .value '10.9' and .unit and .system 'http://unitsofmeasure.org' and .code 'mmol/L'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').value.ofType(Quantity).where(value = 10.9 and unit and system = 'http://unitsofmeasure.org' and code = 'mmol/L').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-0efd45f1-6a9f-11ec-0000-2-id}').value.where($this is Quantity).where(value = 10.9 and unit and system = 'http://unitsofmeasure.org' and code = 'mmol/L').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 2"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '59468-9' and .valueQuantity.value = '1.9'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59468-9')) and value.ofType(Quantity).value = 1.9).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59468-9')) and value.where($this is Quantity).value = 1.9).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59468-9')) and value.ofType(Quantity).value = 1.9).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59468-9')) and value.where($this is Quantity).value = 1.9).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 2-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 2-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '59468-9' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '59468-9' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '59468-9' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .valueQuantity with .value '1.9' and .unit and .system 'http://unitsofmeasure.org' and .code 'fmol'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').value.ofType(Quantity).where(value = 1.9 and unit and system = 'http://unitsofmeasure.org' and code = 'fmol').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-1b29c7f0-6af4-11ec-0000-2-id}').value.where($this is Quantity).where(value = 1.9 and unit and system = 'http://unitsofmeasure.org' and code = 'fmol').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 3"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '58410-2'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '58410-2'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '58410-2'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '58410-2'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '58410-2'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 3-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-4"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '252275004' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '252275004' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '252275004' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '58410-2' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '58410-2' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '58410-2' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-6"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-7"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-7-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-7-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-7 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-8"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-8-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-8-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-8 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-9"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-9-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-9-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-9 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-10"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-10-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-10-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-11"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-11-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-11 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-11-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-11 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-12"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-12-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-12 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-12-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-12 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-13"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-13-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-13 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-13-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-13 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-14"/>
            <description value="Contains .related with .type 'has-member', and .target with either .reference or .identifier and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member' and target.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-14-1"/>
            <description value="Contains .related.type 'has-member'. This assert checks only one child. Assert 3-14 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(type = 'has-member').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-14-2"/>
            <description value="Contains .related.target with either .reference or .identifier and .display. This assert checks only one child. Assert 3-14 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-21eb3319-6aa5-11ec-0000-2-id}').related.where(target.where((reference or identifier) and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 4"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '4544-3' and .valueQuantity.value = '0.50'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '4544-3')) and value.ofType(Quantity).value = 0.50).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '4544-3')) and value.where($this is Quantity).value = 0.50).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '4544-3')) and value.ofType(Quantity).value = 0.50).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '4544-3')) and value.where($this is Quantity).value = 0.50).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 4-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 4-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '4544-3' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '4544-3' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '4544-3' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-6"/>
            <description value="Contains .valueQuantity with .value '0.50' and .unit and .system 'http://unitsofmeasure.org' and .code 'L/L'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').value.ofType(Quantity).where(value = 0.50 and unit and system = 'http://unitsofmeasure.org' and code = 'L/L').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-49f3a93c-6b7c-11ec-0000-2-id}').value.where($this is Quantity).where(value = 0.50 and unit and system = 'http://unitsofmeasure.org' and code = 'L/L').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 5"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '59467-1' and .valueQuantity.value = '23'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59467-1')) and value.ofType(Quantity).value = 23).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59467-1')) and value.where($this is Quantity).value = 23).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '59467-1')) and value.ofType(Quantity).value = 23).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '59467-1')) and value.where($this is Quantity).value = 23).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 5-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 5-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '59467-1' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '59467-1' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '59467-1' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-6"/>
            <description value="Contains .valueQuantity with .value '23' and .unit and .system 'http://unitsofmeasure.org' and .code 'mmol/L'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').value.ofType(Quantity).where(value = 23 and unit and system = 'http://unitsofmeasure.org' and code = 'mmol/L').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-62c4b4f4-6b3a-11ec-0000-2-id}').value.where($this is Quantity).where(value = 23 and unit and system = 'http://unitsofmeasure.org' and code = 'mmol/L').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 6"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '6690-2' and .valueQuantity.value = '10.60'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '6690-2')) and value.ofType(Quantity).value = 10.60).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '6690-2')) and value.where($this is Quantity).value = 10.60).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '6690-2')) and value.ofType(Quantity).value = 10.60).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '6690-2')) and value.where($this is Quantity).value = 10.60).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 6-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 6-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '6690-2' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '6690-2' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '6690-2' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-6"/>
            <description value="Contains .valueQuantity with .value '10.60' and .unit and .system 'http://unitsofmeasure.org' and .code '10*9/L'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').value.ofType(Quantity).where(value = 10.60 and unit and system = 'http://unitsofmeasure.org' and code = '10*9/L').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d3ce4c4f-6b0b-11ec-0000-2-id}').value.where($this is Quantity).where(value = 10.60 and unit and system = 'http://unitsofmeasure.org' and code = '10*9/L').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 7"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '777-3' and .valueQuantity.value = '320'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '777-3')) and value.ofType(Quantity).value = 320).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '777-3')) and value.where($this is Quantity).value = 320).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '777-3')) and value.ofType(Quantity).value = 320).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '777-3')) and value.where($this is Quantity).value = 320).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 7-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 7-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '777-3' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '777-3' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '777-3' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-6"/>
            <description value="Contains .valueQuantity with .value '320' and .unit and .system 'http://unitsofmeasure.org' and .code '10*9/L'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').value.ofType(Quantity).where(value = 320 and unit and system = 'http://unitsofmeasure.org' and code = '10*9/L').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-d58fb225-6ae2-11ec-0000-2-id}').value.where($this is Quantity).where(value = 320 and unit and system = 'http://unitsofmeasure.org' and code = '10*9/L').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 8"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '787-2' and .valueQuantity.value = '95'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '787-2')) and value.ofType(Quantity).value = 95).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '787-2')) and value.where($this is Quantity).value = 95).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '787-2')) and value.ofType(Quantity).value = 95).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '787-2')) and value.where($this is Quantity).value = 95).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 8-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 8-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '787-2' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '787-2' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '787-2' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="8-6"/>
            <description value="Contains .valueQuantity with .value '95' and .unit and .system 'http://unitsofmeasure.org' and .code 'fL'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').value.ofType(Quantity).where(value = 95 and unit and system = 'http://unitsofmeasure.org' and code = 'fL').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-ef908dca-6aae-11ec-0000-2-id}').value.where($this is Quantity).where(value = 95 and unit and system = 'http://unitsofmeasure.org' and code = 'fL').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - LaboratoryTestResult - Check Observation 9"/>
      <description value="Check if the previous operation results in a FHIR Observation that contains the values that are expected following Nictiz' materials (fixture .id: zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Observation with properties: contains .code.coding.code = '789-8' and .valueQuantity.value = '5.2'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '789-8')) and value.ofType(Quantity).value = 5.2).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '789-8')) and value.where($this is Quantity).value = 5.2).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Observation resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(code.where(coding.where(code = '789-8')) and value.ofType(Quantity).value = 5.2).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(code.where(coding.where(code = '789-8')) and value.where($this is Quantity).value = 5.2).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-LaboratoryTestResult-Observation').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-2"/>
            <description value="Contains .status 'final' and with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').status.where($this = 'final' and extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-2-1"/>
            <description value="Contains .status 'final'. This assert checks only one child. Assert 9-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').status = 'final''-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').status = 'final'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-2-2"/>
            <description value="Contains .status.extension with url 'http://nictiz.nl/fhir/StructureDefinition/code-specification' with .valueCodeableConcept with .coding with .system 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and .code 'final' and .display. This assert checks only one child. Assert 9-2 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.ofType(CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').status.extension('http://nictiz.nl/fhir/StructureDefinition/code-specification').value.where($this is CodeableConcept).coding.where(system = 'urn:oid:2.16.840.1.113883.2.4.3.11.60.40.4.16.1' and code = 'final' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '49581000146104' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').category.where(coding.where(system = 'http://snomed.info/sct' and code = '49581000146104' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-4"/>
            <description value="Contains .code with .coding with .system 'http://loinc.org' and .code '789-8' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '789-8' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').code.coding.where(system = 'http://loinc.org' and code = '789-8' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="9-6"/>
            <description value="Contains .valueQuantity with .value '5.2' and .unit and .system 'http://unitsofmeasure.org' and .code '10*12/L'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').value.ofType(Quantity).where(value = 5.2 and unit and system = 'http://unitsofmeasure.org' and code = '10*12/L').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Observation).where(id = '${zib-LabTestResult-msz-f654174f-6abf-11ec-0000-2-id}').value.where($this is Quantity).where(value = 5.2 and unit and system = 'http://unitsofmeasure.org' and code = '10*12/L').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="23-serve-Procedure">
      <name value="Scenario 1.1 - Procedure"/>
      <description value="Serve Procedure resource(s) for HCIM Procedure"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Procedure"/>
            <description value="Test Server to serve Procedure resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;code=http://snomed.info/sct|387713003,http://snomed.info/sct|258174001"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-23-serve-Procedure"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 1"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '71917006'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '71917006'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '71917006'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '71917006'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '71917006'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'in-progress'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').status = 'in-progress''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').status = 'in-progress'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '387713003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '71917006' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '71917006' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '71917006' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-9c1737af-6b4a-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 2"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '73761001'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '73761001'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '73761001'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '73761001'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '73761001'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'in-progress'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').status = 'in-progress''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').status = 'in-progress'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '387713003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '73761001' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '73761001' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '73761001' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .performedPeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').performed.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-765dd3af-6aa7-11ec-0000-2-id}').performed.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 3"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '404628003'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '404628003'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '404628003'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '404628003'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '404628003'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-2"/>
            <description value="Contains .status 'in-progress'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').status = 'in-progress''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').status = 'in-progress'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '387713003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '404628003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '404628003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '404628003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-6"/>
            <description value="Contains .performedPeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').performed.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').performed.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="3-7"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-331c5d72-6b33-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 4"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '1251645009'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '1251645009'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '1251645009'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '1251645009'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '1251645009'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-2"/>
            <description value="Contains .status 'in-progress'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').status = 'in-progress''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').status = 'in-progress'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '258174001' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '258174001' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '258174001' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '1251645009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '1251645009' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '1251645009' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="4-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-338490c2-6b15-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 5"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '447304001'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '447304001'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '447304001'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '447304001'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '447304001'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-2"/>
            <description value="Contains .status 'in-progress'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').status = 'in-progress''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').status = 'in-progress'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '387713003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '447304001' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '447304001' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '447304001' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-6"/>
            <description value="Contains .performedPeriod with .start"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').performed.ofType(Period).start.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').performed.where($this is Period).start.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="5-7"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '24028007' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-f09e5209-6acd-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '24028007' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 6"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '239613002'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '239613002'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '239613002'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '239613002'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '239613002'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-2"/>
            <description value="Contains .extension with url 'http://hl7.org/fhir/StructureDefinition/procedure-method' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '129371009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').extension('http://hl7.org/fhir/StructureDefinition/procedure-method').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '129371009' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').extension('http://hl7.org/fhir/StructureDefinition/procedure-method').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '129371009' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-3"/>
            <description value="Contains .basedOn with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').basedOn.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').basedOn.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-4"/>
            <description value="Contains .status 'completed'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').status = 'completed''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').status = 'completed'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-5"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '387713003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-6"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '239613002' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '239613002' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '239613002' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-7"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-8"/>
            <description value="Contains .performedPeriod with .start and .end"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').performed.ofType(Period).where(start and end).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').performed.where($this is Period).where(start and end).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-9"/>
            <description value="Contains .performer with .actor with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').performer.where(actor.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').performer.where(actor.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-10"/>
            <description value="Contains .bodySite with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display and .coding with .system 'http://snomed.info/sct' and .code '70258002' and .display. This assert checks if all children exist (if applicable with their specific values) and if they are present within one element. Following asserts check if individual children exist to help you debug if this assert fails"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display) and coding.where(system = 'http://snomed.info/sct' and code = '70258002' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display) and coding.where(system = 'http://snomed.info/sct' and code = '70258002' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-10-1"/>
            <description value="Contains .bodySite.extension with url 'http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier' with .valueCodeableConcept with .coding with .system 'http://snomed.info/sct' and .code '7771000' and .display. This assert checks only one child. Assert 6-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.ofType(CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display).exists()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').bodySite.where(extension('http://nictiz.nl/fhir/StructureDefinition/BodySite-Qualifier').value.where($this is CodeableConcept).coding.where(system = 'http://snomed.info/sct' and code = '7771000' and display).exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="6-10-1"/>
            <description value="Contains .bodySite with .coding with .system 'http://snomed.info/sct' and .code '70258002' and .display. This assert checks only one child. Assert 6-10 checks if all children are present in the same parent"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '70258002' and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-ec9ba309-6add-11ec-0000-2-id}').bodySite.where(coding.where(system = 'http://snomed.info/sct' and code = '70258002' and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Procedure - Check Procedure 7"/>
      <description value="Check if the previous operation results in a FHIR Procedure that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Procedure with properties: contains .code.coding.code = '62181000146108'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '62181000146108'))).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '62181000146108'))).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Procedure resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(code.where(coding.where(code = '62181000146108'))).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(code.where(coding.where(code = '62181000146108'))).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Procedure').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-2"/>
            <description value="Contains .status 'in-progress'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').status = 'in-progress''-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').status = 'in-progress'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-3"/>
            <description value="Contains .category with .coding with .system 'http://snomed.info/sct' and .code '387713003' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').category.coding.where(system = 'http://snomed.info/sct' and code = '387713003' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-4"/>
            <description value="Contains .code with .coding with .system 'http://snomed.info/sct' and .code '62181000146108' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '62181000146108' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').code.coding.where(system = 'http://snomed.info/sct' and code = '62181000146108' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="7-5"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Procedure).where(id = '${BgZ-Procedure-msz-bc111b2f-6b31-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="24-serve-Contact">
      <name value="Scenario 1.1 - Contact"/>
      <description value="Serve Encounter resource(s) for HCIM Contact"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Encounter"/>
            <description value="Test Server to serve Encounter resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-24-serve-Contact"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Contact - Check Encounter 1"/>
      <description value="Check if the previous operation results in a FHIR Encounter that contains the values that are expected following Nictiz' materials (fixture .id: zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Encounter with properties: contains .class.code = 'EMER'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(class.code = 'EMER').count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(class.code = 'EMER').count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Encounter resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(class.code = 'EMER').id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(class.code = 'EMER').id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Encounter'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Encounter').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Encounter').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'finished'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').status = 'finished''-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').status = 'finished'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .class with .system 'http://hl7.org/fhir/v3/ActCode' and .code 'EMER' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').class.where(system = 'http://hl7.org/fhir/v3/ActCode' and code = 'EMER' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').class.where(system = 'http://hl7.org/fhir/v3/ActCode' and code = 'EMER' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .period with .start and .end"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').period.where(start and end).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').period.where(start and end).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .diagnosis with .condition with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').diagnosis.where(condition.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').diagnosis.where(condition.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-7"/>
            <description value="Contains .hospitalization with .admitSource with .coding with .system 'http://hl7.org/fhir/v3/NullFlavor' and .code 'OTH' and .display and .text with a value"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').hospitalization.admitSource.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').hospitalization.admitSource.where(coding.where(system = 'http://hl7.org/fhir/v3/NullFlavor' and code = 'OTH' and display) and text.hasValue()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-8"/>
            <description value="Contains .serviceProvider with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').serviceProvider.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-3a9e8b5e-6ac2-11ec-0000-2-id}').serviceProvider.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Contact - Check Encounter 2"/>
      <description value="Check if the previous operation results in a FHIR Encounter that contains the values that are expected following Nictiz' materials (fixture .id: zib-Encounter-msz-d64d3661-6b42-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Encounter with properties: contains .class.code = 'IMP'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(class.code = 'IMP').count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(class.code = 'IMP').count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Encounter resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(class.code = 'IMP').id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(class.code = 'IMP').id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/zib-Encounter'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Encounter').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/zib-Encounter').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-2"/>
            <description value="Contains .status 'finished'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').status = 'finished''-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').status = 'finished'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-3"/>
            <description value="Contains .class with .system 'http://hl7.org/fhir/v3/ActCode' and .code 'IMP' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').class.where(system = 'http://hl7.org/fhir/v3/ActCode' and code = 'IMP' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').class.where(system = 'http://hl7.org/fhir/v3/ActCode' and code = 'IMP' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-4"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-5"/>
            <description value="Contains .period with .start and .end"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').period.where(start and end).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').period.where(start and end).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-6"/>
            <description value="Contains .diagnosis with .condition with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').diagnosis.where(condition.where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').diagnosis.where(condition.where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-7"/>
            <description value="Contains .hospitalization with .dischargeDisposition with .coding with .system 'http://snomed.info/sct' and .code '22232009' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').hospitalization.dischargeDisposition.coding.where(system = 'http://snomed.info/sct' and code = '22232009' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').hospitalization.dischargeDisposition.coding.where(system = 'http://snomed.info/sct' and code = '22232009' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="2-8"/>
            <description value="Contains .serviceProvider with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').serviceProvider.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Encounter).where(id = '${zib-Encounter-msz-d64d3661-6b42-11ec-0000-2-id}').serviceProvider.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="25-serve-ProcedureRequest">
      <name value="Scenario 1.1 - ProcedureRequest"/>
      <description value="Serve ProcedureRequest resource(s) for HCIM Procedure"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="ProcedureRequest"/>
            <description value="Test Server to serve ProcedureRequest resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;status=active"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
   </test>
   <test id="27-serve-Careteam">
      <name value="Scenario 1.1 - Careteam"/>
      <description value="Serve Careteam resource(s)"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="CareTeam"/>
            <description value="Test Server to serve CareTeam resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587&amp;status=active&amp;_include=CareTeam:participant"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-27-serve-Careteam"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the response Bundle contains 1 CareTeam resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(CareTeam)).count() = 1"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Careteam - Check CareTeam"/>
      <description value="Check if the previous operation results in a FHIR CareTeam that contains the values that are expected following Nictiz' materials (fixture .id: nl-core-careteam-msz-a664644d-6b23-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 CareTeam"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="CareTeam resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://fhir.nl/fhir/StructureDefinition/nl-core-careteam'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').meta.profile.where($this = 'http://fhir.nl/fhir/StructureDefinition/nl-core-careteam').exists()'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').meta.profile.where($this = 'http://fhir.nl/fhir/StructureDefinition/nl-core-careteam').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .status 'active'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').status = 'active''-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').status = 'active'"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .subject with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').subject.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .participant with .member with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference' with .valueReference with either .reference or .identifier and .display, and with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').participant.where(member.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.ofType(Reference).where((reference or identifier) and display) and (reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').participant.where(member.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.where($this is Reference).where((reference or identifier) and display) and (reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .participant with .member with .extension with url 'http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference' with .valueReference with either .reference or .identifier and .display, and with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').participant.where(member.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.ofType(Reference).where((reference or identifier) and display) and (reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').participant.where(member.where(extension('http://nictiz.nl/fhir/StructureDefinition/practitionerrole-reference').value.where($this is Reference).where((reference or identifier) and display) and (reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .managingOrganization with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').managingOrganization.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is CareTeam).where(id = '${nl-core-careteam-msz-a664644d-6b23-11ec-0000-2-id}').managingOrganization.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test id="27-serve-Provenance">
      <name value="Scenario 1.1 - Provenance"/>
      <description value="Serve Provenance resource(s)"/>
      <action>
         <operation>
            <type>
               <system value="http://hl7.org/fhir/restful-interaction"/>
               <code value="search"/>
            </type>
            <resource value="Provenance"/>
            <description value="Test Server to serve Provenance resources."/>
            <accept value="json"/>
            <destination value="1"/>
            <encodeRequestUrl value="true"/>
            <origin value="1"/>
            <params value="?patient.identifier=http://fhir.nl/fhir/NamingSystem/bsn|999909587"/>
            <requestHeader>
               <field value="Authorization"/>
               <value value="${patient-token-id}"/>
            </requestHeader>
            <responseId value="fixture-27-serve-Provenance"/>
         </operation>
      </action>
      <action>
         <assert>
            <description value="Confirm that the operation was successful"/>
            <operator value="in"/>
            <responseCode value="200,201"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned resource type is Bundle."/>
            <direction value="response"/>
            <resource value="Bundle"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle type is searchset."/>
            <direction value="response"/>
            <expression value="Bundle.type"/>
            <operator value="equals"/>
            <stopTestOnFail value="false"/>
            <value value="searchset"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources contain an Resource.id except when temporary ids are used in the Bundle. The only time that a resource does not have an id is when it is being submitted to the server using a create operation: https://www.hl7.org/fhir/STU3/resource-definitions.html#Resource.id "/>
            <direction value="response"/>
            <expression value="Bundle.entry.all( $this.fullUrl.matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or $this.fullUrl.matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') or $this.resource.id.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all returned resources except OperationOutcome and Binary contain a meta.profile tag."/>
            <direction value="response"/>
            <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(is(Binary).not()).where(meta.profile.empty()).empty()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl does not disagree with the id in the resource, see http://hl7.org/fhir/stu3/bundle-definitions.html#Bundle.entry.fullUrl"/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(fullUrl.exists() and resource.id.exists()).all($this.fullUrl.endsWith($this.resource.id))"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the fullUrl is an absolute URL, an uuid or an oid."/>
            <direction value="response"/>
            <expression value="Bundle.entry.fullUrl.all( startsWith('http://') or startsWith('https://') or matches('^urn:oid:[0-2](\\.(0|[1-9]\\d*))*$') or matches('^urn:uuid:[A-Fa-f\\d]{8}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{4}-[A-Fa-f\\d]{12}$') )"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
            <direction value="response"/>
            <stopTestOnFail value="false"/>
            <validateProfileId value="Bundle-profile"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Coding elements contain both a .system and a .code."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Coding)).all(system.exists() and code.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the OID of the zib valueset is not used for the system of a coding element."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(coding)).where(system.startsWith('urn:oid:2.16.840.1.113883.2.4.3.11.60.40.2')).exists().not()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all CodeableConcept elements contain either a coding.display or a text value if no Coding exists or has an extension (e.g. a nullFlavor or data-absent-reason extension). For more information see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3Use_of_coded_concepts."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(CodeableConcept)) .all(coding.display.exists() or text.exists() or extension.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all References have a display value, see https://informatiestandaarden.nictiz.nl/wiki/FHIR:V1.0_FHIR_IG_STU3#Use_of_the_reference_datatype."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Reference)).all(display.exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/data-absent-reason').exists() or extension.where(url = 'http://hl7.org/fhir/StructureDefinition/iso21090-nullFlavor').exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that all Identifiers have both a .system and a .value. In rare cases where a general category of identifiers can be used, .type can replace .system. Edge cases for both .system and .type to be unknown are not applicable to Nictiz. For more information, see https://www.hl7.org/fhir/stu3/datatypes.html#Identifier."/>
            <direction value="response"/>
            <expression value="Bundle.descendants().where($this.is(Identifier)).all((system.exists() or type.exists()) and value.exists())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
            <direction value="response"/>
            <expression value="Bundle.total.exists() implies (Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count())"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the returned Bundle contains a self link."/>
            <direction value="response"/>
            <expression value="Bundle.link.where(relation = 'self' and url.exists()).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <extension url="http://touchstone.aegis.net/touchstone/fhir/testing/StructureDefinition/testscript-assert-rule">
               <extension url="ruleId">
                  <valueId value="assert-response-queryParamsInSelfLink"/>
               </extension>
            </extension>
            <description value="Confirm that the parameters in the request URL are all handled by the server, by inspecting the self link."/>
            <stopTestOnFail value="false"/>
            <warningOnly value="true"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Confirm that the response Bundle contains 1 Provenance resource(s). "/>
            <direction value="response"/>
            <expression value="Bundle.entry.where(resource.is(Provenance)).count() = 1"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
   <test>
      <name value="Scenario 1.1 - Provenance - Check Provenance"/>
      <description value="Check if the previous operation results in a FHIR Provenance that contains the values that are expected following Nictiz' materials (fixture .id: BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2)"/>
      <action>
         <assert>
            <description value="Response Bundle contains exactly 1 Provenance"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).count() = 1'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).count() = 1"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <description value="Provenance resource evaluated in the previous assert contains an .id"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).id.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).id.exists()"/>
            <stopTestOnFail value="true"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-1"/>
            <description value="Contains .meta with .profile 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Metadata'"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Metadata').exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').meta.profile.where($this = 'http://nictiz.nl/fhir/StructureDefinition/BgZ-Metadata').exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-2"/>
            <description value="Contains .target with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').target.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').target.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-3"/>
            <description value="Contains .target with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').target.where((reference or identifier) and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').target.where((reference or identifier) and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-4"/>
            <description value="Contains .recorded"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').recorded.exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').recorded.exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-5"/>
            <description value="Contains .activity with .system 'http://hl7.org/fhir/v3/DataOperation' and .code 'CREATE' and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').activity.where(system = 'http://hl7.org/fhir/v3/DataOperation' and code = 'CREATE' and display).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').activity.where(system = 'http://hl7.org/fhir/v3/DataOperation' and code = 'CREATE' and display).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
      <action>
         <assert>
            <label value="1-6"/>
            <description value="Contains .agent with .whoReference with either .reference or .identifier and .display"/>
            <direction value="response"/>
            <!--FHIRPath expressions with .ofType(...) are poorly supported at the moment, so it was rewritten. Original expression: 'Bundle.entry.resource.ofType(Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').agent.where(who.ofType(Reference).where((reference or identifier) and display)).exists()'-->
            <expression value="Bundle.entry.resource.where($this is Provenance).where(id = '${BgZ-Metadata-msz-97c8f361-6aad-11ec-0000-2-id}').agent.where(who.where($this is Reference).where((reference or identifier) and display)).exists()"/>
            <stopTestOnFail value="false"/>
            <warningOnly value="false"/>
         </assert>
      </action>
   </test>
</TestScript>
